(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{538:function(e,t,o){e.exports=o.p+"assets/img/1.a77cdc5b.png"},539:function(e,t,o){e.exports=o.p+"assets/img/2.19ff4acf.png"},602:function(e,t,o){"use strict";o.r(t);var a=o(0),c=Object(a.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"polling-app"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#polling-app"}},[e._v("#")]),e._v(" Polling app")]),e._v(" "),a("p",[a("img",{attrs:{src:o(538),alt:"Application screenshot"}})]),e._v(" "),a("p",[e._v("In this tutorial you will learn how to create a simple blockchain poll application. A user can sign in, create polls, cast votes and see voting results. Creating a poll will cost 200 tokens, voting is free, both actions will be available only for signed in users.")]),e._v(" "),a("h2",{attrs:{id:"requirements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[e._v("#")]),e._v(" Requirements")]),e._v(" "),a("p",[e._v("For this tutorial you will be using "),a("a",{attrs:{href:"https://github.com/tendermint/starport",target:"_blank",rel:"noopener noreferrer"}},[e._v("Starport"),a("OutboundLink")],1),e._v(" v0.15.1, an easy to use tool for building blockchains. To install "),a("code",[e._v("starport")]),e._v(" into "),a("code",[e._v("/usr/local/bin")]),e._v(", run the following command:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"Y3VybCBodHRwczovL2dldC5zdGFycG9ydC5uZXR3b3JrL3N0YXJwb3J0QHYwLjE1LjEhIHwgYmFzaAo="}}),e._v(" "),a("p",[e._v("You can also use Starport v0.15.1 on the web in a "),a("a",{attrs:{href:"http://gitpod.io/#https://github.com/tendermint/starport/tree/v0.15.1",target:"_blank",rel:"noopener noreferrer"}},[e._v("browser-based IDE"),a("OutboundLink")],1),e._v(". Learn more about other ways to "),a("a",{attrs:{href:"https://github.com/tendermint/starport/blob/develop/docs/1%20Introduction/2%20Install.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("install Starport"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"creating-a-blockchain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-blockchain"}},[e._v("#")]),e._v(" Creating a blockchain")]),e._v(" "),a("p",[e._v("Run the following command to create a voter project:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"c3RhcnBvcnQgYXBwIGdpdGh1Yi5jb20vdXNlcm5hbWUvdm90ZXIK"}}),e._v(" "),a("p",[e._v("Starport "),a("code",[e._v("app")]),e._v(" command will scaffold a project structure for your application in a "),a("code",[e._v("voter")]),e._v(" directory. Make sure to replace "),a("code",[e._v("username")]),e._v(" with your GitHub username.")]),e._v(" "),a("p",[e._v("Inside the "),a("code",[e._v("voter")]),e._v(" directory you can see several files and directories:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"Y2Qgdm90ZXIK"}}),e._v(" "),a("ul",[a("li",[a("code",[e._v("app")]),e._v(" contains files that connect all of the moving parts of your application.")]),e._v(" "),a("li",[a("code",[e._v("cmd")]),e._v(" is responsible for the "),a("code",[e._v("voterd")]),e._v(" daemon, which respectively allow you to start your application and interact with it.")]),e._v(" "),a("li",[a("code",[e._v("proto")]),e._v(" contains the protobuffer types of the blockchain application")]),e._v(" "),a("li",[a("code",[e._v("vue")]),e._v(" contains a web user interface for your app, reponsible for everything you see on the screenshot above.")]),e._v(" "),a("li",[a("code",[e._v("x")]),e._v(" contains the main building blocks of you app: modules. Right now we have only one: "),a("code",[e._v("voter")]),e._v(".")])]),e._v(" "),a("p",[e._v("The project's directory contains all the code required to build and launch a blockchain-based app. Try launching the app by running starport serve inside the project:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"c3RhcnBvcnQgc2VydmUK"}}),e._v(" "),a("p",[e._v("You should be able to see the following output - "),a("em",[e._v("as well as any errors that might show up in your application.")])]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"Q29zbW9zIFNESydzIHZlcnNpb24gaXM6IFN0YXJnYXRlIHYwLjQwLjAgKG9yIGFib3ZlKQoK8J+boO+4jyAgQnVpbGRpbmcgcHJvdG8uLi4K8J+TpiBJbnN0YWxsaW5nIGRlcGVuZGVuY2llcy4uLgrwn5ug77iPICBCdWlsZGluZyB0aGUgYXBwLi4uCvCfkr8gSW5pdGlhbGl6aW5nIHRoZSBhcHAuLi4K8J+ZgiBDcmVhdGVkIGFjY291bnQgJnF1b3Q7YWxpY2UmcXVvdDsgd2l0aCBhZGRyZXNzICZxdW90O2Nvc21vczFseDd2cXRzOTd5eGNhbXU4MzhnOGg2cXA1Z3o0ZGR1N2RzZ3E0ayZxdW90OyB3aXRoIG1uZW1vbmljOiAmcXVvdDtmcm9udCBnbG9vbSBzZWxsIHRyb3VibGUgYnV0dGVyIG92YWwgZ2FpbiByZW5ldyBzbG9nYW4gY3JvdWNoIG1hbnVhbCBzcG9uc29yIHNrdWxsIHJvdW5kIGJhbmFuYSBub3RlIGJhbm5lciBnbGFuY2UgY2FyZCB0b3BwbGUgY2lyY2xlIHNsb2dhbiBtb29uIG1vZGVsJnF1b3Q7CvCfmYIgQ3JlYXRlZCBhY2NvdW50ICZxdW90O2JvYiZxdW90OyB3aXRoIGFkZHJlc3MgJnF1b3Q7Y29zbW9zMWFsa2VhOTRrMjBxd2Qzdms2N3FrZzJmbjJhODN6YXV6ZGt6N2dqJnF1b3Q7IHdpdGggbW5lbW9uaWM6ICZxdW90O2FsYXJtIHN0ZXJlbyBjdXRlIHB1cnNlIGNyeXN0YWwgdmVyaWZ5IGdvZGRlc3MgY3JvcCB0aWRlIHNvZGEgdHJpbSBidXR0ZXIgdW5mb2xkIGVtYm9keSBhcnJpdmUgdmVudWUgcHVycG9zZSB2YXBvciB2ZWx2ZXQgb2RvciBvcmJpdCBleHBpcmUgZGlzZWFzZSBjaHVja2xlJnF1b3Q7CvCfjI0gUnVubmluZyBhIENvc21vcyAndm90ZXInIGFwcCB3aXRoIFRlbmRlcm1pbnQgYXQgaHR0cDovL2xvY2FsaG9zdDoyNjY1Ny4K8J+MjSBSdW5uaW5nIGEgc2VydmVyIGF0IGh0dHA6Ly9sb2NhbGhvc3Q6MTMxNyAoTENEKQrwn4yNIFJ1bm5pbmcgYSBmYXVjZXQgYXQgaHR0cDovLzo0NTAwCgrwn5qAIEdldCBzdGFydGVkOiBodHRwOi8vbG9jYWxob3N0OjEyMzQ1Cg=="}}),e._v(" "),a("p",[a("em",[e._v("Note: use")]),e._v(" "),a("code",[e._v("starport serve --verbose")]),e._v(" "),a("em",[e._v("to visualize detailed operations happening in the background")])]),e._v(" "),a("p",[e._v("Congratulations! You now have a blockchain application running on your machine in just two commands. It doesn't do anything yet, add some transaction types next.")]),e._v(" "),a("p",[e._v("The voting applications has two types of entities: polls and votes. A poll is a type that has a "),a("code",[e._v("title")]),e._v(" and a list of "),a("code",[e._v("options")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"add-a-poll-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-a-poll-transaction"}},[e._v("#")]),e._v(" Add a Poll Transaction")]),e._v(" "),a("p",[e._v("Open a new terminal in "),a("code",[e._v("voter")]),e._v(" directory and run the following:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"c3RhcnBvcnQgdHlwZSBwb2xsIHRpdGxlIG9wdGlvbnMK"}}),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"8J+OiSBDcmVhdGVkIGEgdHlwZSBgcG9sbGAK"}}),e._v(" "),a("p",[e._v("This command generated code that handles the creation of "),a("code",[e._v("poll")]),e._v(" items. If you run "),a("code",[e._v("starport serve")]),e._v(" and visit "),a("a",{attrs:{href:"http://localhost:8080",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:8080"),a("OutboundLink")],1),e._v(" you will see a form for creating polls. It may take a short while to rebuild the app, so give it a couple of seconds.")]),e._v(" "),a("p",[a("img",{attrs:{src:o(539),alt:"Application screenshot"}})]),e._v(" "),a("p",[e._v("Sign in with one of the passphrases printed in the console and try creating a poll. Click on "),a("code",[e._v("Access Wallet")]),e._v(" and then "),a("code",[e._v("Import existing wallet")]),e._v(". Enter one of the passphrases that is in your console. Now you can give your wallet a name and password. The wallet can handle multiple accounts, give it a name in order to easier recognise wallets in the future. For this example, naming this wallet "),a("code",[e._v("voter")]),e._v(" would make sense.\nYou can find your newly created transaction type in the "),a("code",[e._v("Custom Type")]),e._v(" navigation point. Enter an example value for Title and Poll option to see the workflow.\nYou should see a new object created and displayed next to the form. You have successfully created an object and stored it on the blockchain!")]),e._v(" "),a("p",[e._v("This, however, does not look and work exactly like initially explained. You should be able to add more option fields (and store them as an array) and they should be displayed as interactive buttons.")]),e._v(" "),a("p",[e._v("Take a look at some of the files modified by the "),a("code",[e._v("starport type")]),e._v(" command.")]),e._v(" "),a("h2",{attrs:{id:"modify-the-protobuffer-types"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modify-the-protobuffer-types"}},[e._v("#")]),e._v(" Modify the Protobuffer Types")]),e._v(" "),a("p",[e._v("To have multiple options, you need to change the value "),a("code",[e._v("string options")]),e._v(" in the Protobuffer definitions. Open the "),a("code",[e._v("proto/voter")]),e._v(" directory and look into the "),a("code",[e._v("poll.proto")]),e._v(" and "),a("code",[e._v("tx.proto")]),e._v(" files.")]),e._v(" "),a("p",[e._v("Add the keyword "),a("code",[e._v("repeated")]),e._v(" before the options to allow passing an array of strings.\nIn the "),a("code",[e._v("proto/voter/poll.proto")]),e._v(" file, modify the Poll message options field as follows:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"proto",base64:"bWVzc2FnZSBQb2xsIHsKICBzdHJpbmcgY3JlYXRvciA9IDE7CiAgdWludDY0IGlkID0gMjsKICBzdHJpbmcgdGl0bGUgPSAzOyAKICByZXBlYXRlZCBzdHJpbmcgb3B0aW9ucyA9IDQ7IAp9Cg=="}}),e._v(" "),a("p",[e._v("In the "),a("code",[e._v("proto/voter/tx.proto")]),e._v(" file you have the CRUD (Create, Read, Update and Delete) types for the poll transaction. Update the "),a("code",[e._v("options")]),e._v(" field for the messages "),a("code",[e._v("MsgCreatePoll")]),e._v(" and "),a("code",[e._v("MsgUpdatePoll")]),e._v(".")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"proto",base64:"bWVzc2FnZSBNc2dDcmVhdGVQb2xsIHsKICBzdHJpbmcgY3JlYXRvciA9IDE7CiAgc3RyaW5nIHRpdGxlID0gMjsKICByZXBlYXRlZCBzdHJpbmcgb3B0aW9ucyA9IDM7Cn0K"}}),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"proto",base64:"bWVzc2FnZSBNc2dVcGRhdGVQb2xsIHsKICBzdHJpbmcgY3JlYXRvciA9IDE7CiAgdWludDY0IGlkID0gMjsKICBzdHJpbmcgdGl0bGUgPSAzOwogIHJlcGVhdGVkIHN0cmluZyBvcHRpb25zID0gNDsKfQo="}}),e._v(" "),a("h2",{attrs:{id:"modify-the-poll-transaction-message"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modify-the-poll-transaction-message"}},[e._v("#")]),e._v(" Modify the Poll Transaction Message")]),e._v(" "),a("p",[e._v("Navigate to the file at "),a("code",[e._v("x/voter/types/message_poll.go")]),e._v(".")]),e._v(" "),a("p",[e._v("This file defines a message that creates a poll.")]),e._v(" "),a("p",[e._v("We need to make options to be stored as a list instead of a string. Replace "),a("code",[e._v("options string")]),e._v(" with "),a("code",[e._v("options []string")]),e._v(" in the "),a("code",[e._v("NewMsgCreatePoll")]),e._v(" and "),a("code",[e._v("NewMsgUpdatePoll")]),e._v(" functions.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC92b3Rlci90eXBlcy9tZXNzYWdlX3BvbGwuZ28KZnVuYyBOZXdNc2dDcmVhdGVQb2xsKGNyZWF0b3Igc3RyaW5nLCB0aXRsZSBzdHJpbmcsIG9wdGlvbnMgW11zdHJpbmcpICpNc2dDcmVhdGVQb2xsIHsKCXJldHVybiAmYW1wO01zZ0NyZWF0ZVBvbGx7CgkJQ3JlYXRvcjogY3JlYXRvciwKCQlUaXRsZTogICB0aXRsZSwKCQlPcHRpb25zOiBvcHRpb25zLAoJfQp9Cg=="}}),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC92b3Rlci90eXBlcy9tZXNzYWdlX3BvbGwuZ28KZnVuYyBOZXdNc2dVcGRhdGVQb2xsKGNyZWF0b3Igc3RyaW5nLCBpZCB1aW50NjQsIHRpdGxlIHN0cmluZywgb3B0aW9ucyBbXXN0cmluZykgKk1zZ1VwZGF0ZVBvbGwgewoJcmV0dXJuICZhbXA7TXNnVXBkYXRlUG9sbHsKCQlJZDogICAgICBpZCwKCQlDcmVhdG9yOiBjcmVhdG9yLAoJCVRpdGxlOiAgIHRpdGxlLAoJCU9wdGlvbnM6IG9wdGlvbnMsCgl9Cn0K"}}),e._v(" "),a("p",[e._v("To write anything to a blockchain or perform any other state transition a client (web app in our case) makes an HTTP POST request with a title and options to "),a("a",{attrs:{href:"http://localhost:1317/voter/poll",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:1317/voter/poll"),a("OutboundLink")],1),e._v(" endpoint handler for which is defined in "),a("code",[e._v("x/voter/client/rest/txPoll.go")]),e._v(". The handler creates an unsigned transaction which contains an array of messages. The client then signs the transaction and sends it to "),a("a",{attrs:{href:"http://localhost:1317/txs",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:1317/txs"),a("OutboundLink")],1),e._v(". The application processes the transaction by sending each message to a corresponding handler, in our case "),a("code",[e._v("x/voter/handler.go")]),e._v(". A handler then calls a "),a("code",[e._v("CreatePoll")]),e._v(" function defined in "),a("code",[e._v("x/voter/keeper/poll.go")]),e._v(" which writes the poll data into the store.")]),e._v(" "),a("h2",{attrs:{id:"modify-the-poll-keeper"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modify-the-poll-keeper"}},[e._v("#")]),e._v(" Modify the Poll Keeper")]),e._v(" "),a("p",[e._v("The keeper adds the polls to the blockchain database.")]),e._v(" "),a("p",[e._v("Navigate to the file at "),a("code",[e._v("x/voter/keeper/poll.go")]),e._v(" and change the "),a("code",[e._v("options")]),e._v(" parameter from "),a("code",[e._v("string")]),e._v(" to "),a("code",[e._v("[]string")]),e._v(" in the "),a("code",[e._v("AppendPoll")]),e._v(" function")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC92b3Rlci9rZWVwZXIvcG9sbC5nbwpmdW5jIChrIEtlZXBlcikgQXBwZW5kUG9sbCgKCWN0eCBzZGsuQ29udGV4dCwKCWNyZWF0b3Igc3RyaW5nLAoJdGl0bGUgc3RyaW5nLAoJb3B0aW9ucyBbXXN0cmluZywKKSB1aW50NjQgewoJLy8gQ3JlYXRlIHRoZSBwb2xsCgljb3VudCA6PSBrLkdldFBvbGxDb3VudChjdHgpCgl2YXIgcG9sbCA9IHR5cGVzLlBvbGx7CgkJQ3JlYXRvcjogY3JlYXRvciwKCQlJZDogICAgICBjb3VudCwKCQlUaXRsZTogICB0aXRsZSwKCQlPcHRpb25zOiBvcHRpb25zLAoJfQoKCXN0b3JlIDo9IHByZWZpeC5OZXdTdG9yZShjdHguS1ZTdG9yZShrLnN0b3JlS2V5KSwgdHlwZXMuS2V5UHJlZml4KHR5cGVzLlBvbGxLZXkpKQoJdmFsdWUgOj0gay5jZGMuTXVzdE1hcnNoYWxCaW5hcnlCYXJlKCZhbXA7cG9sbCkKCXN0b3JlLlNldChHZXRQb2xsSURCeXRlcyhwb2xsLklkKSwgdmFsdWUpCgoJLy8gVXBkYXRlIHBvbGwgY291bnQKCWsuU2V0UG9sbENvdW50KGN0eCwgY291bnQrMSkKCglyZXR1cm4gY291bnQKfQo="}}),e._v(" "),a("h2",{attrs:{id:"modify-the-rest-endpoint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modify-the-rest-endpoint"}},[e._v("#")]),e._v(" Modify the REST Endpoint")]),e._v(" "),a("p",[e._v("The rest endpoint is defined in the file "),a("code",[e._v("x/voter/client/rest/txPoll.go")]),e._v(".")]),e._v(" "),a("p",[e._v("Replace "),a("code",[e._v("Options string")]),e._v(" with "),a("code",[e._v("Options []string")]),e._v(" in "),a("code",[e._v("createPollRequest")]),e._v(" struct.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"dHlwZSBjcmVhdGVQb2xsUmVxdWVzdCBzdHJ1Y3QgewoJQmFzZVJlcSByZXN0LkJhc2VSZXEgYGpzb246JnF1b3Q7YmFzZV9yZXEmcXVvdDtgCglDcmVhdG9yIHN0cmluZyAgICAgICBganNvbjomcXVvdDtjcmVhdG9yJnF1b3Q7YAoJVGl0bGUgICBzdHJpbmcgICAgICAgYGpzb246JnF1b3Q7dGl0bGUmcXVvdDtgCglPcHRpb25zIFtdc3RyaW5nICAgICBganNvbjomcXVvdDtvcHRpb25zJnF1b3Q7YAp9Cg=="}}),e._v(" "),a("p",[e._v("Also further below in the "),a("code",[e._v("updatePollRequest")]),e._v(" struct.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"dHlwZSB1cGRhdGVQb2xsUmVxdWVzdCBzdHJ1Y3QgewoJQmFzZVJlcSByZXN0LkJhc2VSZXEgYGpzb246JnF1b3Q7YmFzZV9yZXEmcXVvdDtgCglDcmVhdG9yIHN0cmluZyAgICAgICBganNvbjomcXVvdDtjcmVhdG9yJnF1b3Q7YAoJVGl0bGUgICBzdHJpbmcgICAgICAgYGpzb246JnF1b3Q7dGl0bGUmcXVvdDtgCglPcHRpb25zIFtdc3RyaW5nICAgICBganNvbjomcXVvdDtvcHRpb25zJnF1b3Q7YAp9Cg=="}}),e._v(" "),a("h3",{attrs:{id:"modify-the-cli-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modify-the-cli-transaction"}},[e._v("#")]),e._v(" Modify the CLI Transaction")]),e._v(" "),a("p",[e._v("A user will also be able to interact with our application through a command line interface.")]),e._v(" "),a("p",[e._v("The CLI definition is available at "),a("code",[e._v("x/voter/client/cli/txPoll.go")]),e._v(".")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"dm90ZXJjbGkgdHggdm90ZXIgY3JlYXRlLXBvbGwgJnF1b3Q7VGV4dCBlZGl0b3JzJnF1b3Q7ICZxdW90O0VtYWNzJnF1b3Q7ICZxdW90O1ZpbSZxdW90OyAtLWZyb20gYWxpY2UK"}}),e._v(" "),a("p",[e._v('This command will generate a transaction with "create poll" message, sign it using a private key of '),a("code",[e._v("alice")]),e._v(" (one of two users created by default) and broadcast it to the blockchain.")]),e._v(" "),a("p",[e._v("The modification we need to make is to change a line that reads arguments from the console.")]),e._v(" "),a("p",[e._v("In the function "),a("code",[e._v("CmdCreatePoll")])]),e._v(" "),a("p",[e._v("replace")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"QXJnczogIGNvYnJhLkV4YWN0QXJncygyKSwK"}}),e._v(" "),a("p",[e._v("with")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"QXJnczogIGNvYnJhLk1pbmltdW1OQXJncygyKSwK"}}),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"YXJnc09wdGlvbnMgOj0gYXJnc1sxOmxlbihhcmdzKV0K"}}),e._v(" "),a("p",[e._v("The variable "),a("code",[e._v("msg")]),e._v(" is defined to read a string of argOptions, delete the stringification")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"bXNnIDo9IHR5cGVzLk5ld01zZ0NyZWF0ZVBvbGwoY2xpZW50Q3R4LkdldEZyb21BZGRyZXNzKCkuU3RyaW5nKCksIHN0cmluZyhhcmdzVGl0bGUpLCBhcmdzT3B0aW9ucykK"}}),e._v(" "),a("p",[e._v("We end up with the following function")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBDbWRDcmVhdGVQb2xsKCkgKmNvYnJhLkNvbW1hbmQgewoJY21kIDo9ICZhbXA7Y29icmEuQ29tbWFuZHsKCQlVc2U6ICAgJnF1b3Q7Y3JlYXRlLXBvbGwgW3RpdGxlXSBbb3B0aW9uc10mcXVvdDssCgkJU2hvcnQ6ICZxdW90O0NyZWF0ZXMgYSBuZXcgcG9sbCZxdW90OywKCQlBcmdzOiAgY29icmEuTWluaW11bU5BcmdzKDIpLAoJCVJ1bkU6IGZ1bmMoY21kICpjb2JyYS5Db21tYW5kLCBhcmdzIFtdc3RyaW5nKSBlcnJvciB7CgkJCWFyZ3NUaXRsZSA6PSBzdHJpbmcoYXJnc1swXSkKCQkJYXJnc09wdGlvbnMgOj0gYXJnc1sxOmxlbihhcmdzKV0KCgkJCWNsaWVudEN0eCwgZXJyIDo9IGNsaWVudC5HZXRDbGllbnRUeENvbnRleHQoY21kKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoKCQkJbXNnIDo9IHR5cGVzLk5ld01zZ0NyZWF0ZVBvbGwoY2xpZW50Q3R4LkdldEZyb21BZGRyZXNzKCkuU3RyaW5nKCksIHN0cmluZyhhcmdzVGl0bGUpLCBhcmdzT3B0aW9ucykKCQkJaWYgZXJyIDo9IG1zZy5WYWxpZGF0ZUJhc2ljKCk7IGVyciAhPSBuaWwgewoJCQkJcmV0dXJuIGVycgoJCQl9CgkJCXJldHVybiB0eC5HZW5lcmF0ZU9yQnJvYWRjYXN0VHhDTEkoY2xpZW50Q3R4LCBjbWQuRmxhZ3MoKSwgbXNnKQoJCX0sCgl9CgoJZmxhZ3MuQWRkVHhGbGFnc1RvQ21kKGNtZCkKCglyZXR1cm4gY21kCn0K"}}),e._v(" "),a("p",[e._v("Similar changes will need to be done for the function "),a("code",[e._v("CmdUpdatePoll")])]),e._v(" "),a("p",[e._v("And in the "),a("code",[e._v("CmdUpdatePoll")]),e._v(" we set")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"QXJnczogIGNvYnJhLkV4YWN0QXJncygzKSwK"}}),e._v(" "),a("p",[e._v("to")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"QXJnczogIGNvYnJhLk1pbmltdW1OQXJncygzKSwK"}}),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"YXJnc09wdGlvbnMgOj0gYXJnc1syOmxlbihhcmdzKV0K"}}),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"bXNnIDo9IHR5cGVzLk5ld01zZ1VwZGF0ZVBvbGwoY2xpZW50Q3R4LkdldEZyb21BZGRyZXNzKCkuU3RyaW5nKCksIGlkLCBzdHJpbmcoYXJnc1RpdGxlKSwgYXJnc09wdGlvbnMpCg=="}}),e._v(" "),a("p",[e._v("This will assume that all arguments after the first one represent a list of options.")]),e._v(" "),a("p",[e._v("You end up with the following function")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBDbWRVcGRhdGVQb2xsKCkgKmNvYnJhLkNvbW1hbmQgewoJY21kIDo9ICZhbXA7Y29icmEuQ29tbWFuZHsKCQlVc2U6ICAgJnF1b3Q7dXBkYXRlLXBvbGwgW2lkXSBbdGl0bGVdIFtvcHRpb25zXSZxdW90OywKCQlTaG9ydDogJnF1b3Q7VXBkYXRlIGEgcG9sbCZxdW90OywKCQlBcmdzOiAgY29icmEuTWluaW11bU5BcmdzKDMpLAoJCVJ1bkU6IGZ1bmMoY21kICpjb2JyYS5Db21tYW5kLCBhcmdzIFtdc3RyaW5nKSBlcnJvciB7CgkJCWlkLCBlcnIgOj0gc3RyY29udi5QYXJzZVVpbnQoYXJnc1swXSwgMTAsIDY0KQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoKCQkJYXJnc1RpdGxlIDo9IHN0cmluZyhhcmdzWzFdKQoJCQlhcmdzT3B0aW9ucyA6PSBhcmdzWzI6bGVuKGFyZ3MpXQoKCQkJY2xpZW50Q3R4LCBlcnIgOj0gY2xpZW50LkdldENsaWVudFR4Q29udGV4dChjbWQpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJcmV0dXJuIGVycgoJCQl9CgoJCQltc2cgOj0gdHlwZXMuTmV3TXNnVXBkYXRlUG9sbChjbGllbnRDdHguR2V0RnJvbUFkZHJlc3MoKS5TdHJpbmcoKSwgaWQsIHN0cmluZyhhcmdzVGl0bGUpLCBhcmdzT3B0aW9ucykKCQkJaWYgZXJyIDo9IG1zZy5WYWxpZGF0ZUJhc2ljKCk7IGVyciAhPSBuaWwgewoJCQkJcmV0dXJuIGVycgoJCQl9CgkJCXJldHVybiB0eC5HZW5lcmF0ZU9yQnJvYWRjYXN0VHhDTEkoY2xpZW50Q3R4LCBjbWQuRmxhZ3MoKSwgbXNnKQoJCX0sCgl9CgoJZmxhZ3MuQWRkVHhGbGFnc1RvQ21kKGNtZCkKCglyZXR1cm4gY21kCn0K"}}),e._v(" "),a("p",[e._v("In order for the app to recognize the changes that you have made, reset the application first before running it the next time")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"c3RhcnBvcnQgc2VydmUgLS1yZXNldC1vbmNlCg=="}}),e._v(" "),a("h2",{attrs:{id:"add-the-votes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-the-votes"}},[e._v("#")]),e._v(" Add the Votes")]),e._v(" "),a("p",[e._v("Up to now you have created a blockchain where users can create polls. Users will need to vote on the options of the poll.\nCreate the code to cast votes on an existing poll.")]),e._v(" "),a("p",[e._v("A vote type transaction has the poll ID and an option - the string representation of the selected answer.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"c3RhcnBvcnQgdHlwZSB2b3RlIHBvbGxJRCBvcHRpb24K"}}),e._v(" "),a("p",[e._v("Now restart the application with")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"c3RhcnBvcnQgc2VydmUgLS1yZXNldC1vbmNlCg=="}}),e._v(" "),a("p",{attrs:{synopsis:""}},[e._v("Remember, every time you reset the application state, you will have new passphrases. The reset restores all the data from your previously created state and you will receive new passphrases with new tokens. Mind to update your wallet accounts in the frontend once you reset the state of the blockchain.")]),e._v(" "),a("p",[e._v("Now that you have made all the necessary changes to the app, take a look at the client-side application.")]),e._v(" "),a("h3",{attrs:{id:"front-end-application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#front-end-application"}},[e._v("#")]),e._v(" Front-end application")]),e._v(" "),a("p",[e._v("Starport has generated a basic front-end for the app. For convenience "),a("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js"),a("OutboundLink")],1),e._v(" framework is used with "),a("a",{attrs:{href:"https://vuex.vuejs.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vuex"),a("OutboundLink")],1),e._v(" for state management, but since all features of the app are exposed through an HTTP API, clients can be built using any language or framework.")]),e._v(" "),a("p",[e._v("You will be mostly interested in "),a("code",[e._v("vue/src/views")]),e._v(" directory and the "),a("code",[e._v("vue/src/components")]),e._v(" directory. These directories contain the code for the page templates of our app. "),a("code",[e._v("vue/src/store/")]),e._v(" handles sending transactions and receiving data from our blockchain and "),a("a",{attrs:{href:"https://github.com/tendermint/vue/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("@tendermint/vue")]),a("OutboundLink")],1),e._v(" directory, which contains components, like buttons and forms. It contains the generated protobuffer file definitions that were defined in the "),a("code",[e._v("vue/src/store/generated/username/voter/username.voter.voter")]),e._v(" directory.")]),e._v(" "),a("p",[e._v("Inside "),a("code",[e._v("vue/src/store/generated/username/voter/username.voter.voter/index.js")]),e._v(" you can see the generated transactions "),a("code",[e._v("MsgCreatePoll")]),e._v(", "),a("code",[e._v("MsgUpdatePoll")]),e._v(", "),a("code",[e._v("MsgDeletePoll")]),e._v(" which use "),a("a",{attrs:{href:"https://github.com/cosmwasm/cosmjs",target:"_blank",rel:"noopener noreferrer"}},[e._v("CosmJS"),a("OutboundLink")],1),e._v(", a library for handling wallets, creating, signing and broadcasting transactions and define a Vuex store.")]),e._v(" "),a("h2",{attrs:{id:"add-your-module-component-to-the-frontend"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-your-module-component-to-the-frontend"}},[e._v("#")]),e._v(" Add your Module Component to the Frontend")]),e._v(" "),a("p",[e._v("Navigate to the views directory in "),a("code",[e._v("vue/src/views")])]),e._v(" "),a("p",[e._v("Since we don't need the default form component replace inside of "),a("code",[e._v("vue/src/views/Types.vue")])]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"Jmx0O1NwVHlwZSBtb2R1bGVQYXRoPSZxdW90O3VzZXJuYW1lLnZvdGVyLnZvdGVyJnF1b3Q7IG1vZHVsZVR5cGU9JnF1b3Q7Vm90ZSZxdW90OyAgLyZndDsKJmx0O1NwVHlwZSBtb2R1bGVQYXRoPSZxdW90O3VzZXJuYW1lLnZvdGVyLnZvdGVyJnF1b3Q7IG1vZHVsZVR5cGU9JnF1b3Q7UG9sbCZxdW90OyAgLyZndDsK"}}),e._v(" "),a("p",[e._v("with two new components and a title")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"ICAgCQkmbHQ7U3BIMyZndDsKICAgCQkJVm90ZXIgTW9kdWxlCiAgIAkJJmx0Oy9TcEgzJmd0OwogICAJCSZsdDtwb2xsLWZvcm0gLyZndDsKICAgCQkmbHQ7cG9sbC1saXN0IC8mZ3Q7Cg=="}}),e._v(" "),a("p",[e._v("In the "),a("code",[e._v("<script><\/script>")]),e._v(" tags below, import the component like this")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"aW1wb3J0IFBvbGxGb3JtIGZyb20gJnF1b3Q7Li4vY29tcG9uZW50cy9Qb2xsRm9ybSZxdW90OzsKaW1wb3J0IFBvbGxMaXN0IGZyb20gJnF1b3Q7Li4vY29tcG9uZW50cy9Qb2xsTGlzdCZxdW90OzsKCmV4cG9ydCBkZWZhdWx0IHsKCW5hbWU6ICdUeXBlcycsCgljb21wb25lbnRzOiB7IFBvbGxGb3JtLCBQb2xsTGlzdCB9LAp9Cg=="}}),e._v(" "),a("p",[e._v("Start creating the components.")]),e._v(" "),a("h2",{attrs:{id:"create-the-pollform-component"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-pollform-component"}},[e._v("#")]),e._v(" Create the PollForm Component")]),e._v(" "),a("p",[e._v("For the PollForm, create a new file "),a("code",[e._v("PollForm.vue")]),e._v(" in the "),a("code",[e._v("vue/src/components")]),e._v(" directory.")]),e._v(" "),a("p",[e._v("The component has a title and two buttons.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"vue",base64:"Jmx0O3RlbXBsYXRlJmd0OwogICZsdDtkaXYmZ3Q7CiAgICAmbHQ7ZGl2IGNsYXNzPSZxdW90O3NwLXZvdGVyX19tYWluIHNwLWJveCBzcC1zaGFkb3cgc3AtZm9ybS1ncm91cCZxdW90OyZndDsKICAgICAgICAmbHQ7Zm9ybSBjbGFzcz0mcXVvdDtzcC12b3Rlcl9fbWFpbl9fZm9ybSZxdW90OyZndDsKICAgICAgICAgICZsdDtkaXYgY2xhc3M9JnF1b3Q7c3Atdm90ZXJfX21haW5fX3JjcHRfX2hlYWRlciBzcC1ib3gtaGVhZGVyJnF1b3Q7Jmd0OwogICAgICAgICAgICBDcmVhdGUgYSBQb2xsCiAgICAgICAgICAmbHQ7L2RpdiZndDsKCiAgICAgICAgICAmbHQ7aW5wdXQgY2xhc3M9JnF1b3Q7c3AtaW5wdXQmcXVvdDsgcGxhY2Vob2xkZXI9JnF1b3Q7VGl0bGUmcXVvdDsgdi1tb2RlbD0mcXVvdDt0aXRsZSZxdW90OyAvJmd0OwogICAgICAgICAgJmx0O2RpdiB2LWZvcj0mcXVvdDsob3B0aW9uLCBpbmRleCkgaW4gb3B0aW9ucyZxdW90OyB2LWJpbmQ6a2V5PSZxdW90OydvcHRpb24nICsgaW5kZXgmcXVvdDsmZ3Q7CiAgICAgICAgICAgICZsdDtpbnB1dCBjbGFzcz0mcXVvdDtzcC1pbnB1dCZxdW90OyBwbGFjZWhvbGRlcj0mcXVvdDtPcHRpb24mcXVvdDsgdi1tb2RlbD0mcXVvdDtvcHRpb24udGl0bGUmcXVvdDsgLyZndDsKICAgICAgICAgICZsdDsvZGl2Jmd0OwogICAgICAgICAgJmx0O3NwLWJ1dHRvbiBAY2xpY2s9JnF1b3Q7YWRkJnF1b3Q7Jmd0OysgQWRkIG9wdGlvbiZsdDsvc3AtYnV0dG9uJmd0OwogICAgICAgICAgJmx0O3NwLWJ1dHRvbiBAY2xpY2s9JnF1b3Q7c3VibWl0JnF1b3Q7Jmd0O0NyZWF0ZSBwb2xsJmx0Oy9zcC1idXR0b24mZ3Q7CiAgICAgICAgJmx0Oy9mb3JtJmd0OwogICAgJmx0Oy9kaXYmZ3Q7CiAgJmx0Oy9kaXYmZ3Q7CiZsdDsvdGVtcGxhdGUmZ3Q7Cg=="}}),e._v(" "),a("p",[e._v("In between "),a("code",[e._v("<script><\/script>")]),e._v(" tags below the javacsript code.\nThe Form manages the input of the user and broadcasts the transaction to the blockchain if the form gets submitted.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"ZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICZxdW90O1BvbGxGb3JtJnF1b3Q7LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0aXRsZTogJnF1b3Q7JnF1b3Q7LAogICAgICBvcHRpb25zOiBbewogICAgICAgIHRpdGxlOiAmcXVvdDsmcXVvdDssCiAgICAgIH1dLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CgoJCWN1cnJlbnRBY2NvdW50KCkgewoJCQlpZiAodGhpcy5fZGVwc0xvYWRlZCkgewoJCQkJaWYgKHRoaXMubG9nZ2VkSW4pIHsKCQkJCQlyZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY29tbW9uL3dhbGxldC9hZGRyZXNzJ10KCQkJCX0gZWxzZSB7CgkJCQkJcmV0dXJuIG51bGwKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXJldHVybiBudWxsCgkJCX0KCQl9LAoJCWxvZ2dlZEluKCkgewoJCQlpZiAodGhpcy5fZGVwc0xvYWRlZCkgewoJCQkJcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NvbW1vbi93YWxsZXQvbG9nZ2VkSW4nXQoJCQl9IGVsc2UgewoJCQkJcmV0dXJuIGZhbHNlCgkJCX0KCQl9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhZGQoKSB7CiAgICAgIHRoaXMub3B0aW9ucyA9IFsuLi50aGlzLm9wdGlvbnMsIHsgdGl0bGU6ICZxdW90OyZxdW90OyB9XTsKICAgIH0sCiAgICBhc3luYyBzdWJtaXQoKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gewogICAgICAgIGNyZWF0b3I6IHRoaXMuY3VycmVudEFjY291bnQsCiAgICAgICAgdGl0bGU6IHRoaXMudGl0bGUsCiAgICAgICAgb3B0aW9uczogdGhpcy5vcHRpb25zLm1hcCgobykgPSZndDsgby50aXRsZSksCiAgICAgIH07CiAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCZxdW90O3VzZXJuYW1lLnZvdGVyLnZvdGVyL3NlbmRNc2dDcmVhdGVQb2xsJnF1b3Q7LCB7CiAgICAgICAgdmFsdWUsCiAgICAgICAgZmVlOiBbXSwKICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="}}),e._v(" "),a("p",[e._v("Refresh the page, sign in with a password and create a new poll. It takes a couple of seconds to process a transaction. Now, if you visit "),a("a",{attrs:{href:"http://localhost:1317/voter/poll",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:1317/voter/poll"),a("OutboundLink")],1),e._v(" you should see a list of polls (this endpoint is defined in "),a("code",[e._v("x/voter/client/rest/queryPoll.go")]),e._v("):")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"ewogICZxdW90O2hlaWdodCZxdW90OzogJnF1b3Q7MCZxdW90OywKICAmcXVvdDtyZXN1bHQmcXVvdDs6IFsKICAgIHsKICAgICAgJnF1b3Q7Y3JlYXRvciZxdW90OzogJnF1b3Q7Y29zbW9zMTlxcWE3ajczNzM1dzRwY3g5bWtrYXhyMDBhZjdwNDMybjYydHY2JnF1b3Q7LAogICAgICAmcXVvdDtpZCZxdW90OzogJnF1b3Q7ODI2NDc3YWItMDAwNS00ZTY4LTgwMzEtMTk3NThkMzMxNjgxJnF1b3Q7LAogICAgICAmcXVvdDt0aXRsZSZxdW90OzogJnF1b3Q7QSBwb2xsIHRpdGxlJnF1b3Q7LAogICAgICAmcXVvdDtvcHRpb25zJnF1b3Q7OiBbJnF1b3Q7Rmlyc3Qgb3B0aW9uJnF1b3Q7LCAmcXVvdDtUaGUgc2Vjb25kIG9wdGlvbiZxdW90O10KICAgIH0KICBdCn0K"}}),e._v(" "),a("h3",{attrs:{id:"create-the-poll-list-component"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-poll-list-component"}},[e._v("#")]),e._v(" Create the Poll List Component")]),e._v(" "),a("p",[e._v("Create a new component "),a("code",[e._v("PollList.vue")]),e._v(" in "),a("code",[e._v("vue/src/components/PollList.vue")]),e._v(".")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"Jmx0O3RlbXBsYXRlJmd0OwogICZsdDtkaXYmZ3Q7CiAgICAmbHQ7U3BIMyZndDsgTGlzdCBvZiBQb2xscyAmbHQ7L1NwSDMmZ3Q7CiAgICAmbHQ7ZGl2IHYtZm9yPSZxdW90O3BvbGwgaW4gcG9sbHMmcXVvdDsgdi1iaW5kOmtleT0mcXVvdDsncG9sbCcgKyBwb2xsLmlkJnF1b3Q7Jmd0OwogICAgICAmbHQ7U3BIMyZndDsge3twb2xsLmlkfX0uIHt7IHBvbGwudGl0bGUgfX0gJmx0Oy9TcEgzJmd0OwogICAgICAmbHQ7YXBwLXJhZGlvLWl0ZW0KICAgICAgICBAY2xpY2s9JnF1b3Q7c3VibWl0KHBvbGwuaWQsIG9wdGlvbikmcXVvdDsKICAgICAgICB2LWZvcj0mcXVvdDtvcHRpb24gaW4gcG9sbC5vcHRpb25zJnF1b3Q7CiAgICAgICAgdi1iaW5kOmtleT0mcXVvdDtvcHRpb24mcXVvdDsKICAgICAgICA6dmFsdWU9JnF1b3Q7b3B0aW9uJnF1b3Q7CiAgICAgIC8mZ3Q7CiAgICAgICZsdDthcHAtdGV4dCB0eXBlPSZxdW90O3N1YnRpdGxlJnF1b3Q7Jmd0O1Jlc3VsdHM6IHt7IHJlc3VsdHMocG9sbC5pZCkgfX0mbHQ7L2FwcC10ZXh0Jmd0OwogICAgJmx0Oy9kaXYmZ3Q7CiAgJmx0Oy9kaXYmZ3Q7CiZsdDsvdGVtcGxhdGUmZ3Q7CiZsdDtzdHlsZSZndDsKLm9wdGlvbi1yYWRpbyAmZ3Q7IC5idXR0b24gewogIGhlaWdodDogNDBweDsKICB3aWR0aDogNTAlOwp9CiZsdDsvc3R5bGUmZ3Q7Cg=="}}),e._v(" "),a("p",[e._v("in between "),a("code",[e._v("<script><\/script>")]),e._v(" tags below this:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"aW1wb3J0IEFwcFJhZGlvSXRlbSBmcm9tICZxdW90Oy4vQXBwUmFkaW9JdGVtJnF1b3Q7OwppbXBvcnQgQXBwVGV4dCBmcm9tICZxdW90Oy4vQXBwVGV4dCZxdW90OzsKaW1wb3J0IHsgY291bnRCeSB9IGZyb20gJnF1b3Q7bG9kYXNoJnF1b3Q7OwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgQXBwVGV4dCwgQXBwUmFkaW9JdGVtIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNlbGVjdGVkOiAmcXVvdDsmcXVvdDssCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKCgkJY3VycmVudEFjY291bnQoKSB7CgkJCWlmICh0aGlzLl9kZXBzTG9hZGVkKSB7CgkJCQlpZiAodGhpcy5sb2dnZWRJbikgewoJCQkJCXJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjb21tb24vd2FsbGV0L2FkZHJlc3MnXQoJCQkJfSBlbHNlIHsKCQkJCQlyZXR1cm4gbnVsbAoJCQkJfQoJCQl9IGVsc2UgewoJCQkJcmV0dXJuIG51bGwKCQkJfQoJCX0sCgkJbG9nZ2VkSW4oKSB7CgkJCWlmICh0aGlzLl9kZXBzTG9hZGVkKSB7CgkJCQlyZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY29tbW9uL3dhbGxldC9sb2dnZWRJbiddCgkJCX0gZWxzZSB7CgkJCQlyZXR1cm4gZmFsc2UKCQkJfQoJCX0sCiAgICBwb2xscygpIHsKICAgICAgcmV0dXJuICgKICAgICAgICB0aGlzLiRzdG9yZS5nZXR0ZXJzWyZxdW90O3VzZXJuYW1lLnZvdGVyLnZvdGVyL2dldFBvbGxBbGwmcXVvdDtdKHsKICAgICAgICAgIHBhcmFtczoge30KICAgICAgICB9KT8uUG9sbCA/PyBbXQogICAgICApOwogICAgfSwKICAgIHZvdGVzKCkgewogICAgICByZXR1cm4gKAogICAgICAgIHRoaXMuJHN0b3JlLmdldHRlcnNbJnF1b3Q7dXNlcm5hbWUudm90ZXIudm90ZXIvZ2V0Vm90ZUFsbCZxdW90O10oewogICAgICAgICAgcGFyYW1zOiB7fQogICAgICAgIH0pPy5Wb3RlID8/IFtdCiAgICAgICk7CiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgcmVzdWx0cyhpZCkgewogICAgICBjb25zdCByZXN1bHRzID0gdGhpcy52b3Rlcy5maWx0ZXIoKHYpID0mZ3Q7IHYucG9sbElEID09PSBpZCk7CiAgICAgIHJldHVybiBjb3VudEJ5KHJlc3VsdHMsICZxdW90O29wdGlvbiZxdW90Oyk7CiAgICB9LAogICAgYXN5bmMgc3VibWl0KHBvbGxJRCwgb3B0aW9uKSB7CiAgICAgIAogICAgICBjb25zdCB2YWx1ZSA9IHsgY3JlYXRvcjogdGhpcy5jdXJyZW50QWNjb3VudCwgcG9sbElELCBvcHRpb24gfTsKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJnF1b3Q7dXNlcm5hbWUudm90ZXIudm90ZXIvc2VuZE1zZ0NyZWF0ZVZvdGUmcXVvdDssIHsKICAgICAgICB2YWx1ZSwKICAgICAgICBmZWU6IFtdLAogICAgICB9KTsKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJnF1b3Q7dXNlcm5hbWUudm90ZXIudm90ZXIvUXVlcnlQb2xsQWxsJnF1b3Q7LCB7CiAgICAgICAgb3B0aW9uczogeyBzdWJzY3JpYmU6IHRydWUsIGFsbDogdHJ1ZSB9LAogICAgICAgIHBhcmFtczoge30sCiAgICAgIH0pOwogICAgfSwKICB9LAp9Owo="}}),e._v(" "),a("p",[e._v("The "),a("code",[e._v("PollList")]),e._v(" component lists every poll, including the options for that poll as buttons. Selecting an option triggers a "),a("code",[e._v("submit")]),e._v(' method that broadcasts a transaction with a "create vote" message and fetches data back from our application.')]),e._v(" "),a("p",[e._v("Two components are still missing from our App, to make it a bit better looking. Let's add "),a("code",[e._v("AppRadioItem.vue")]),e._v(" and "),a("code",[e._v("AppText.vue")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"add-the-options-component"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-the-options-component"}},[e._v("#")]),e._v(" Add the Options Component")]),e._v(" "),a("p",[a("code",[e._v("vue/src/components/AppRadioItem.vue")])]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"Jmx0O3RlbXBsYXRlJmd0OwogICZsdDtkaXYmZ3Q7CiAgICAmbHQ7YnV0dG9uIGNsYXNzPSZxdW90O2J1dHRvbiZxdW90OyZndDt7eyB2YWx1ZSB9fSZsdDsvYnV0dG9uJmd0OwogICZsdDsvZGl2Jmd0OwombHQ7L3RlbXBsYXRlJmd0OwoKJmx0O3N0eWxlIHNjb3BlZCZndDsKLmJ1dHRvbiB7CiAgYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHJnYmEoMCwgMCwgMCwgMC4xKTsKICBwYWRkaW5nOiAwLjc1cmVtIDFyZW07CiAgbWFyZ2luLWJvdHRvbTogMC41cmVtOwogIGJvcmRlci1yYWRpdXM6IDZweDsKICB1c2VyLXNlbGVjdDogbm9uZTsKICBjdXJzb3I6IHBvaW50ZXI7CiAgdHJhbnNpdGlvbjogYWxsIDAuMXM7CiAgZm9udC13ZWlnaHQ6IDUwMDsKICBvdXRsaW5lOiBub25lOwogIGJvcmRlcjogbm9uZTsKICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDEpOwogIHdpZHRoOiAxMDAlOwogIGZvbnQtZmFtaWx5OiBpbmhlcml0OwogIHRleHQtYWxpZ246IGxlZnQ7CiAgZm9udC1zaXplOiAxcmVtOwogIGZvbnQtd2VpZ2h0OiBpbmhlcml0Owp9Ci5idXR0b246aG92ZXIgewogIGJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCByZ2JhKDAsIDAsIDAsIDAuMSksCiAgICAwIDFweCA1cHggLTFweCByZ2JhKDAsIDAsIDAsIDAuMSk7Cn0KLmJ1dHRvbjpmb2N1cyB7CiAgYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHJnYmEoMCwgMCwgMCwgMC4yKSwKICAgIDAgMXB4IDVweCAtMXB4IHJnYmEoMCwgMCwgMCwgMC4xKTsKfQouYnV0dG9uOmFjdGl2ZSB7CiAgYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHJnYmEoMCwgMCwgMCwgMC4wNyk7CiAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC43KTsKICB0cmFuc2Zvcm06IHNjYWxlKDAuOTk4KTsKfQombHQ7L3N0eWxlJmd0Owo="}}),e._v(" "),a("p",[e._v("In the "),a("code",[e._v("<script><\/script>")]),e._v(" tag below this:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"ZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICB2YWx1ZTogJnF1b3Q7JnF1b3Q7LAogIH0sCn07Cg=="}}),e._v(" "),a("h3",{attrs:{id:"add-the-poll-list-text-component"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-the-poll-list-text-component"}},[e._v("#")]),e._v(" Add the Poll List Text Component")]),e._v(" "),a("p",[a("code",[e._v("vue/src/components/AppText.vue")])]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"Jmx0O3RlbXBsYXRlJmd0OwogICZsdDtkaXYmZ3Q7CiAgICAmbHQ7ZGl2IDpjbGFzcz0mcXVvdDtbYCR7dHlwZX1gXSZxdW90OyZndDsKICAgICAgJmx0O3Nsb3QgLyZndDsKICAgICZsdDsvZGl2Jmd0OwogICZsdDsvZGl2Jmd0OwombHQ7L3RlbXBsYXRlJmd0OwoKJmx0O3N0eWxlIHNjb3BlZCZndDsKLmgxIHsKICBmb250LXNpemU6IDJyZW07CiAgZm9udC13ZWlnaHQ6IDgwMDsKICBsZXR0ZXItc3BhY2luZzogMC4wM2VtOwogIG1hcmdpbi1ib3R0b206IDJyZW07Cn0KLmgyIHsKICBmb250LXdlaWdodDogODAwOwogIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgbGV0dGVyLXNwYWNpbmc6IDAuMDVlbTsKICBtYXJnaW4tYm90dG9tOiAwLjVyZW07CiAgbWFyZ2luLXRvcDogMnJlbTsKfQouc3VidGl0bGUgewogIGNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNSk7CiAgZm9udC1zaXplOiAwLjg1cmVtOwp9CiZsdDsvc3R5bGUmZ3Q7Cg=="}}),e._v(" "),a("p",[e._v("In between "),a("code",[e._v("<script><\/script>")]),e._v(" tags below this")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"ZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICB0eXBlOiB7CiAgICAgIGRlZmF1bHQ6ICZxdW90O3AxJnF1b3Q7LAogICAgfSwKICB9LAp9Owo="}}),e._v(" "),a("p",[e._v("Now in the "),a("code",[e._v("App.vue")]),e._v(" you need to update the JavaScript to fetch the votes.")]),e._v(" "),a("h3",{attrs:{id:"update-the-frontend-app"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#update-the-frontend-app"}},[e._v("#")]),e._v(" Update the Frontend App")]),e._v(" "),a("p",[e._v("The App file handles the transactions of the components. Modify the script in "),a("code",[e._v("vue/src/App.vue")]),e._v(" to look the following")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"aW1wb3J0ICcuL3Njc3MvYXBwLnNjc3MnCmltcG9ydCAnQHN0YXJwb3J0L3Z1ZS9saWIvc3RhcnBvcnQtdnVlLmNzcycKaW1wb3J0IFNpZGViYXIgZnJvbSAnLi9jb21wb25lbnRzL1NpZGViYXInCgpleHBvcnQgZGVmYXVsdCB7Cgljb21wb25lbnRzOiB7CgkJU2lkZWJhcgoJfSwKCWRhdGEoKSB7CgkJcmV0dXJuIHsKCQkJaW5pdGlhbGl6ZWQ6IGZhbHNlCgkJfQoJfSwKCWNvbXB1dGVkOiB7CgkJaGFzV2FsbGV0KCkgewoJCQlyZXR1cm4gdGhpcy4kc3RvcmUuaGFzTW9kdWxlKFsgJ2NvbW1vbicsICd3YWxsZXQnXSkKCQl9Cgl9LAoJYXN5bmMgY3JlYXRlZCgpIHsKCQlhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY29tbW9uL2Vudi9pbml0JykKCQl0aGlzLmluaXRpYWxpemVkID0gdHJ1ZQoJCWF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCZxdW90O3VzZXJuYW1lLnZvdGVyLnZvdGVyL1F1ZXJ5UG9sbEFsbCZxdW90Oyx7b3B0aW9uczp7c3Vic2NyaWJlOnRydWUsIGFsbDp0cnVlfSxwYXJhbXM6e319KQoJCWF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCZxdW90O3VzZXJuYW1lLnZvdGVyLnZvdGVyL1F1ZXJ5Vm90ZUFsbCZxdW90Oyx7b3B0aW9uczp7c3Vic2NyaWJlOnRydWUsIGFsbDp0cnVlfSxwYXJhbXM6e319KQoJfSwKCWVycm9yQ2FwdHVyZWQoZXJyKSB7CgkJY29uc29sZS5sb2coZXJyKQoJCXJldHVybiBmYWxzZQoJfQp9Cg=="}}),e._v(" "),a("p",[e._v("By now should be able to see the same UI as in the first screenshot. Try creating polls and casting votes.\nYou may notice that it's possible to cast multiple votes for one poll. This is not what we want, so let's fix this behaviour.")]),e._v(" "),a("h2",{attrs:{id:"access-the-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#access-the-api"}},[e._v("#")]),e._v(" Access the API")]),e._v(" "),a("p",[e._v("To fix this issue you first have to understand how data is stored in our application.")]),e._v(" "),a("p",[e._v("Think of the data storage as a lexicographically ordered key value store.\nYou can loop through the entries, filter by key prefix, add, update and delete entries.\nIt is easier to visualize the store as JSON.")]),e._v(" "),a("p",[e._v("When you create a poll and cast on vote, this is the resulting JSON.")]),e._v(" "),a("p",[e._v("See the API and JSON output of your created Poll endpoint at "),a("a",{attrs:{href:"http://localhost:1317/username/voter/voter/poll",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:1317/username/voter/voter/poll"),a("OutboundLink")],1)]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"ewogICZxdW90O1BvbGwmcXVvdDs6IFsKICAgIHsKICAgICAgJnF1b3Q7Y3JlYXRvciZxdW90OzogJnF1b3Q7Y29zbW9zMXZlZGQ5N2t1Mm44cXRzY2NyZm5hNWdnMHJlcGRuazBhOWNsN3plJnF1b3Q7LAogICAgICAmcXVvdDtpZCZxdW90OzogJnF1b3Q7MCZxdW90OywKICAgICAgJnF1b3Q7dGl0bGUmcXVvdDs6ICZxdW90O1NvZnQgZHJpbmtzJnF1b3Q7LAogICAgICAmcXVvdDtvcHRpb25zJnF1b3Q7OiBbJnF1b3Q7Q29jYS1Db2xhJnF1b3Q7LCAmcXVvdDtQZXBzaSZxdW90O10KICAgIH0KICBdLAogICZxdW90O3BhZ2luYXRpb24mcXVvdDs6IHsKICAgICZxdW90O25leHRfa2V5JnF1b3Q7OiBudWxsLAogICAgJnF1b3Q7dG90YWwmcXVvdDs6ICZxdW90OzEmcXVvdDsKICB9Cn0K"}}),e._v(" "),a("p",[e._v("For the votes you can go to the API page on "),a("a",{attrs:{href:"http://localhost:1317/username/voter/voter/vote",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:1317/username/voter/voter/vote"),a("OutboundLink")],1)]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"CnsKICAmcXVvdDtWb3RlJnF1b3Q7OiBbCiAgICB7CiAgICAgICZxdW90O2NyZWF0b3ImcXVvdDs6ICZxdW90O2Nvc21vczF2ZWRkOTdrdTJuOHF0c2NjcmZuYTVnZzByZXBkbmswYTljbDd6ZSZxdW90OywKICAgICAgJnF1b3Q7aWQmcXVvdDs6ICZxdW90OzAmcXVvdDssCiAgICAgICZxdW90O3BvbGxJRCZxdW90OzogJnF1b3Q7MCZxdW90OywKICAgICAgJnF1b3Q7b3B0aW9uJnF1b3Q7OiAmcXVvdDtQZXBzaSZxdW90OwogICAgfQogIF0sCiAgJnF1b3Q7cGFnaW5hdGlvbiZxdW90OzogewogICAgJnF1b3Q7bmV4dF9rZXkmcXVvdDs6IG51bGwsCiAgICAmcXVvdDt0b3RhbCZxdW90OzogJnF1b3Q7MiZxdW90OwogIH0KfQo="}}),e._v(" "),a("p",[e._v("The endpoint paths are defined by the username you use when bootstrapping the application with Starport, together with your module name.")]),e._v(" "),a("p",[e._v("Looking into this data, you can see the combination of "),a("code",[e._v("creator")]),e._v(" and "),a("code",[e._v("pollID")]),e._v(" is what we are looking for. Each account should only be allowed to have 1 vote per pollID.")]),e._v(" "),a("h2",{attrs:{id:"limit-to-one-vote-per-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#limit-to-one-vote-per-user"}},[e._v("#")]),e._v(" Limit to One Vote per User")]),e._v(" "),a("p",[e._v("The logic for access to a certain transaction should be in the "),a("code",[e._v("keeper")]),e._v(" directory. For the votes transaction logic, open the "),a("code",[e._v("msg_server_vote.go")]),e._v(" file at "),a("code",[e._v("x/voter/keeper/msg_server_vote.go")]),e._v(" and modify the "),a("code",[e._v("CreateVote")]),e._v(" function.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyAoayBtc2dTZXJ2ZXIpIENyZWF0ZVZvdGUoZ29DdHggY29udGV4dC5Db250ZXh0LCBtc2cgKnR5cGVzLk1zZ0NyZWF0ZVZvdGUpICgqdHlwZXMuTXNnQ3JlYXRlVm90ZVJlc3BvbnNlLCBlcnJvcikgewoJY3R4IDo9IHNkay5VbndyYXBTREtDb250ZXh0KGdvQ3R4KQoKICAJLy8gR2V0IGFsbCBleGlzdGluZyB2b3RlcwoJdm90ZUxpc3QgOj0gay5HZXRBbGxWb3RlKGN0eCkKCWZvciBfLCBleGlzdGluZ1ZvdGUgOj0gcmFuZ2Ugdm90ZUxpc3QgewogICAgCS8vIENoZWNrIGlmIHRoZSBhY2NvdW50IGhhcyBhbHJlYWR5IHZvdGVkIG9uIHRoaXMgUG9sbElECgkJaWYgZXhpc3RpbmdWb3RlLkNyZWF0b3IgPT0gbXNnLkNyZWF0b3IgJmFtcDsmYW1wOyBleGlzdGluZ1ZvdGUuUG9sbElEID09IG1zZy5Qb2xsSUQgewogICAgICAJCS8vIFJldHVybiBhbiBlcnJvciB3aGVuIGEgdm90ZSBoYXMgYmVlbiBjYXN0ZWQgYnkgdGhpcyBhY2NvdW50IG9uIHRoaXMgUG9sbElECgkJCXJldHVybiBuaWwsIHNka2Vycm9ycy5XcmFwKHNka2Vycm9ycy5FcnJVbmF1dGhvcml6ZWQsICZxdW90O1ZvdGUgYWxyZWFkeSBjYXN0ZWQuJnF1b3Q7KQoJCX0KCX0KCglpZCA6PSBrLkFwcGVuZFZvdGUoCgkJY3R4LAoJCW1zZy5DcmVhdG9yLAoJCW1zZy5Qb2xsSUQsCgkJbXNnLk9wdGlvbiwKCSkKCglyZXR1cm4gJmFtcDt0eXBlcy5Nc2dDcmVhdGVWb3RlUmVzcG9uc2V7CgkJSWQ6IGlkLAoJfSwgbmlsCn0K"}}),e._v(" "),a("p",[e._v("Now when you restart the app, in the frontend you should be able to only cast 1 vote per poll.")]),e._v(" "),a("h2",{attrs:{id:"introducing-a-fee-for-creating-polls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introducing-a-fee-for-creating-polls"}},[e._v("#")]),e._v(" Introducing a fee for creating polls")]),e._v(" "),a("p",[e._v("Add the logic for the transaction, that creating a poll costs 200 tokens.")]),e._v(" "),a("p",[e._v("We already require users to have accounts registered, and each user has tokens on balance. The only thing you need to do is to send coins from user's account to a module account before we create a poll.")]),e._v(" "),a("h2",{attrs:{id:"add-the-bank-keeper-to-the-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-the-bank-keeper-to-the-module"}},[e._v("#")]),e._v(" Add the Bank Keeper to the Module")]),e._v(" "),a("p",[e._v("First, load the "),a("code",[e._v("expected_keepers")]),e._v(" in the "),a("code",[e._v("x/voter/types/expected_keepers.go")]),e._v(" file.\nThis will define all the bank functions available in your module.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSB0eXBlcwoKaW1wb3J0IHNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CgovLyBCYW5rS2VlcGVyIGRlZmluZXMgdGhlIGV4cGVjdGVkIGJhbmsga2VlcGVyCnR5cGUgQmFua0tlZXBlciBpbnRlcmZhY2UgewoJU2VuZENvaW5zKGN0eCBzZGsuQ29udGV4dCwgZnJvbUFkZHIgc2RrLkFjY0FkZHJlc3MsIHRvQWRkciBzZGsuQWNjQWRkcmVzcywgYW10IHNkay5Db2lucykgZXJyb3IKCU1pbnRDb2lucyhjdHggc2RrLkNvbnRleHQsIG1vZHVsZU5hbWUgc3RyaW5nLCBhbXQgc2RrLkNvaW5zKSBlcnJvcgoJQnVybkNvaW5zKGN0eCBzZGsuQ29udGV4dCwgbW9kdWxlTmFtZSBzdHJpbmcsIGFtdCBzZGsuQ29pbnMpIGVycm9yCglTZW5kQ29pbnNGcm9tTW9kdWxlVG9BY2NvdW50KGN0eCBzZGsuQ29udGV4dCwgc2VuZGVyTW9kdWxlIHN0cmluZywgcmVjaXBpZW50QWRkciBzZGsuQWNjQWRkcmVzcywgYW10IHNkay5Db2lucykgZXJyb3IKCVNlbmRDb2luc0Zyb21BY2NvdW50VG9Nb2R1bGUoY3R4IHNkay5Db250ZXh0LCBzZW5kZXJBZGRyIHNkay5BY2NBZGRyZXNzLCByZWNpcGllbnRNb2R1bGUgc3RyaW5nLCBhbXQgc2RrLkNvaW5zKSBlcnJvcgp9Cg=="}}),e._v(" "),a("p",[e._v("Second, add the keeper to the "),a("code",[e._v("x/voter/keeper/keeper.go")]),e._v(" file.\nAdd it to the "),a("code",[e._v("type")]),e._v(" as well as the "),a("code",[e._v("NewKeeper")]),e._v(" function as follows:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"dHlwZSAoCglLZWVwZXIgc3RydWN0IHsKCQljZGMgICAgICAgIGNvZGVjLk1hcnNoYWxlcgoJCXN0b3JlS2V5ICAgc2RrLlN0b3JlS2V5CgkJbWVtS2V5ICAgICBzZGsuU3RvcmVLZXkKCQliYW5rS2VlcGVyIHR5cGVzLkJhbmtLZWVwZXIKCX0KKQoKZnVuYyBOZXdLZWVwZXIoY2RjIGNvZGVjLk1hcnNoYWxlciwgc3RvcmVLZXksIG1lbUtleSBzZGsuU3RvcmVLZXksIGJhbmtLZWVwZXIgdHlwZXMuQmFua0tlZXBlcikgKktlZXBlciB7CglyZXR1cm4gJmFtcDtLZWVwZXJ7CgkJY2RjOiAgICAgICAgY2RjLAoJCXN0b3JlS2V5OiAgIHN0b3JlS2V5LAoJCW1lbUtleTogICAgIG1lbUtleSwKCQliYW5rS2VlcGVyOiBiYW5rS2VlcGVyLAoJfQp9Cg=="}}),e._v(" "),a("p",[e._v("Finally, add the bank module to the "),a("code",[e._v("app.go")]),e._v(" file in "),a("code",[e._v("x/app/app.go")])]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"YXBwLnZvdGVyS2VlcGVyID0gKnZvdGVya2VlcGVyLk5ld0tlZXBlcigKICBhcHBDb2RlYywga2V5c1t2b3RlcnR5cGVzLlN0b3JlS2V5XSwga2V5c1t2b3RlcnR5cGVzLk1lbVN0b3JlS2V5XSwgYXBwLkJhbmtLZWVwZXIsCikK"}}),e._v(" "),a("p",[e._v("Now you are ready to use all the bank functions that you added to the expected keepers file above.\nNext you will define how the transaction will require the funds in order to exectue the transaction.")]),e._v(" "),a("h2",{attrs:{id:"modify-the-message-with-the-price"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modify-the-message-with-the-price"}},[e._v("#")]),e._v(" Modify the Message with the price")]),e._v(" "),a("p",[e._v("Modify the msg at "),a("code",[e._v("x/voter/keeper/msg_server_poll.go")]),e._v(".")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBrZWVwZXIKCmltcG9ydCAoCgkmcXVvdDtjb250ZXh0JnF1b3Q7CgkmcXVvdDtmbXQmcXVvdDsKCglzZGsgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcyZxdW90OwoJc2RrZXJyb3JzICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvdHlwZXMvZXJyb3JzJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL3RlbmRlcm1pbnQvdGVuZGVybWludC9jcnlwdG8mcXVvdDsKCSZxdW90O2dpdGh1Yi5jb20vdXNlcm5hbWUvdm90ZXIveC92b3Rlci90eXBlcyZxdW90OwopCgpmdW5jIChrIG1zZ1NlcnZlcikgQ3JlYXRlUG9sbChnb0N0eCBjb250ZXh0LkNvbnRleHQsIG1zZyAqdHlwZXMuTXNnQ3JlYXRlUG9sbCkgKCp0eXBlcy5Nc2dDcmVhdGVQb2xsUmVzcG9uc2UsIGVycm9yKSB7CgljdHggOj0gc2RrLlVud3JhcFNES0NvbnRleHQoZ29DdHgpCgoJbW9kdWxlQWNjdCA6PSBzZGsuQWNjQWRkcmVzcyhjcnlwdG8uQWRkcmVzc0hhc2goW11ieXRlKHR5cGVzLk1vZHVsZU5hbWUpKSkKCWZlZUNvaW5zLCBlcnIgOj0gc2RrLlBhcnNlQ29pbnNOb3JtYWxpemVkKCZxdW90OzIwMHRva2VuJnF1b3Q7KQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyCgl9CgljcmVhdG9yQWRkcmVzcywgZXJyIDo9IHNkay5BY2NBZGRyZXNzRnJvbUJlY2gzMihtc2cuQ3JlYXRvcikKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoJaWYgZXJyIDo9IGsuYmFua0tlZXBlci5TZW5kQ29pbnMoY3R4LCBjcmVhdG9yQWRkcmVzcywgbW9kdWxlQWNjdCwgZmVlQ29pbnMpOyBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCglpZCA6PSBrLkFwcGVuZFBvbGwoCgkJY3R4LAoJCW1zZy5DcmVhdG9yLAoJCW1zZy5UaXRsZSwKCQltc2cuT3B0aW9ucywKCSkKCglyZXR1cm4gJmFtcDt0eXBlcy5Nc2dDcmVhdGVQb2xsUmVzcG9uc2V7CgkJSWQ6IGlkLAoJfSwgbmlsCn0K"}}),e._v(" "),a("p",[e._v("The fee payment happens before "),a("code",[e._v("k.AppendPoll")]),e._v(". This way, if a user does not have enough tokens, the application will raise an error and will not proceed to creating a poll. Make sure to have "),a("code",[e._v('"github.com/tendermint/tendermint/crypto"')]),e._v(" added to the import statement (if your text editor didn't do that for you).")]),e._v(" "),a("p",[e._v("Now, restart the app and try creating several polls to see how this affects your token balance.")]),e._v(" "),a("p",[e._v("Congratulations, you have built a blockchain voting application.")])],1)}),[],!1,null,null,null);t.default=c.exports}}]);