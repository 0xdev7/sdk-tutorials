(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{806:function(t,a,e){"use strict";e.r(a);var s=e(1),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"ibc-foreign-token-wager"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ibc-foreign-token-wager"}},[t._v("#")]),t._v(" IBC Foreign Token Wager")]),t._v(" "),e("HighlightBox",{attrs:{type:"synopsis"}},[e("p",[t._v("Make sure you have all you need before proceeding:")]),t._v(" "),e("ul",[e("li",[t._v("You understand the concepts of "),e("RouterLink",{attrs:{to:"/academy/2-main-concepts/messages.html"}},[t._v("messages")]),t._v(", "),e("RouterLink",{attrs:{to:"/academy/2-main-concepts/protobuf.html"}},[t._v("Protobuf")]),t._v(", and "),e("RouterLink",{attrs:{to:"/academy/2-main-concepts/ibc.html"}},[t._v("IBC")]),t._v(".")],1),t._v(" "),e("li",[t._v("Have Go installed.")]),t._v(" "),e("li",[t._v("The checkers blockchain codebase up to the "),e("em",[t._v("can play")]),t._v(" query. You can get there by following the "),e("RouterLink",{attrs:{to:"/academy/4-my-own-chain/can-play.html"}},[t._v("previous steps")]),t._v(" or checking out the "),e("a",{attrs:{href:"https://github.com/cosmos/b9-checkers-academy-draft/tree/can-play-move-handler",target:"_blank",rel:"noopener noreferrer"}},[t._v("relevant version"),e("OutboundLink")],1),t._v(".")],1)])]),t._v(" "),e("p",[t._v("When you "),e("RouterLink",{attrs:{to:"/academy/4-my-own-chain/game-wager.html"}},[t._v("introduced a wager")]),t._v(" you made it possible for players to play a game and wager the base staking token of your blockchain application. What if your players want to play with other "),e("em",[t._v("currencies")]),t._v("? Your blockchain can represent a token from any other blockchain connected to your chain by using the Inter-Blockchain Communication Protocol (IBC).")],1),t._v(" "),e("p",[t._v("You will be agnostic about the tokens that are represented and about who is taking care of the relayers. Your only concern is to enable the use of "),e("em",[t._v("foreign")]),t._v(" tokens.")]),t._v(" "),e("h2",{attrs:{id:"new-information"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#new-information"}},[t._v("#")]),t._v(" New information")]),t._v(" "),e("p",[t._v("Instead of defaulting to "),e("code",[t._v('"stake"')]),t._v(", let players decide what string represents their token. So you update:")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("The stored game:")]),t._v(" "),e("div",{staticClass:"language-protobuf [https://github.com/cosmos/b9-checkers-academy-draft/blob/9799e2cee1a0541932ec19d5cfdcdd955be0390f/proto/checkers/stored_game.proto#L21] extra-class"},[e("pre",{pre:!0,attrs:{class:"language-protobuf"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("message")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StoredGame")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Denomination of the wager.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("The message to create a game:")]),t._v(" "),e("div",{staticClass:"language-protobuf [https://github.com/cosmos/b9-checkers-academy-draft/blob/9799e2cee1a0541932ec19d5cfdcdd955be0390f/proto/checkers/tx.proto#L46] extra-class"},[e("pre",{pre:!0,attrs:{class:"language-protobuf"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("message")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MsgCreateGame")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Denomination of the wager.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),e("p",[t._v("To have Starport and Protobuf recompile both files, you can use:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("$ starport generate proto-go\n")])])]),e("p",[t._v("To avoid surprises down the road, also update the "),e("code",[t._v("MsgCreateGame")]),t._v(" constructor:")]),t._v(" "),e("div",{staticClass:"language-go [https://github.com/cosmos/b9-checkers-academy-draft/blob/9799e2cee1a0541932ec19d5cfdcdd955be0390f/x/checkers/types/message_create_game.go#L16] extra-class"},[e("pre",{pre:!0,attrs:{class:"language-go"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewMsgCreateGame")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("creator "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" red "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" black "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" wager "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint64")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" token "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("MsgCreateGame "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("MsgCreateGame"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        Token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("You already know that you are going to emit this new information during the game creation. So add a new event key as a constant:")]),t._v(" "),e("div",{staticClass:"language-go [https://github.com/cosmos/b9-checkers-academy-draft/blob/9799e2cee1a0541932ec19d5cfdcdd955be0390f/x/checkers/types/keys.go#L56] extra-class"},[e("pre",{pre:!0,attrs:{class:"language-go"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    StoredGameEventToken "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Token"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h2",{attrs:{id:"additional-handling"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#additional-handling"}},[t._v("#")]),t._v(" Additional handling")]),t._v(" "),e("p",[t._v("You have prepared the ground by placing this token denomination into the relevant data structures. Now the proper values need to be inserted in the relevant locations:")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("In the helper function to create the "),e("code",[t._v("Coin")]),t._v(" in "),e("code",[t._v("full_game.go")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-go [https://github.com/cosmos/b9-checkers-academy-draft/blob/9799e2cee1a0541932ec19d5cfdcdd955be0390f/x/checkers/types/full_game.go#L71-L73] extra-class"},[e("pre",{pre:!0,attrs:{class:"language-go"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("storedGame "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("StoredGame"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetWagerCoin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wager sdk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Coin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" sdk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewCoin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("storedGame"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sdk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewInt")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("int64")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("storedGame"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Wager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("In the handler that instantiates a game:")]),t._v(" "),e("div",{staticClass:"language-go [https://github.com/cosmos/b9-checkers-academy-draft/blob/9799e2cee1a0541932ec19d5cfdcdd955be0390f/x/checkers/keeper/msg_server_create_game.go#L30] extra-class"},[e("pre",{pre:!0,attrs:{class:"language-go"}},[e("code",[t._v("storedGame "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" types"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StoredGame"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    Token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("     msg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Not to forget where it emits an event:")]),t._v(" "),e("div",{staticClass:"language-go [https://github.com/cosmos/b9-checkers-academy-draft/blob/9799e2cee1a0541932ec19d5cfdcdd955be0390f/x/checkers/keeper/msg_server_create_game.go#L54] extra-class"},[e("pre",{pre:!0,attrs:{class:"language-go"}},[e("code",[t._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("EventManager")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("EmitEvent")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    sdk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewEvent")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sdk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EventTypeMessage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        sdk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewAttribute")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("types"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StoredGameEventToken"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),e("h2",{attrs:{id:"next-up"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#next-up"}},[t._v("#")]),t._v(" Next up")]),t._v(" "),e("p",[t._v("In the "),e("RouterLink",{attrs:{to:"/academy/4-my-own-chain/migration.html"}},[t._v("next section")]),t._v(" you will learn how to conduct chain upgrades through migrations.")],1)],1)}),[],!1,null,null,null);a.default=n.exports}}]);