(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{638:function(Z,c,l){"use strict";l.r(c);var b=l(1),d=Object(b.a)({},(function(){var Z=this,c=Z.$createElement,l=Z._self._c||c;return l("ContentSlotsDistributor",{attrs:{"slot-key":Z.$parent.slotKey}},[l("h1",{attrs:{id:"keeper"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#keeper"}},[Z._v("#")]),Z._v(" Keeper")]),Z._v(" "),l("h2",{attrs:{id:"create-scavenge"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#create-scavenge"}},[Z._v("#")]),Z._v(" Create Scavenge")]),Z._v(" "),l("p",[Z._v("Create scavenge method should do the following:")]),Z._v(" "),l("ul",[l("li",[Z._v("Check that a scavenge with a given solution hash doesn't exist")]),Z._v(" "),l("li",[Z._v("Send tokens from scavenge creator account to a module account")]),Z._v(" "),l("li",[Z._v("Write the scavenge to the store")])]),Z._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9zY2F2ZW5nZS9rZWVwZXIvbXNnX3NlcnZlcl9zdWJtaXRfc2NhdmVuZ2UuZ28KcGFja2FnZSBrZWVwZXIKCmltcG9ydCAoCgkmcXVvdDtjb250ZXh0JnF1b3Q7CgoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb25hdXQvc2NhdmVuZ2UveC9zY2F2ZW5nZS90eXBlcyZxdW90OwoJc2RrICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvdHlwZXMmcXVvdDsKCSZxdW90O2dpdGh1Yi5jb20vdGVuZGVybWludC90ZW5kZXJtaW50L2NyeXB0byZxdW90OwoJc2RrZXJyb3JzICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvdHlwZXMvZXJyb3JzJnF1b3Q7CikKCmZ1bmMgKGsgbXNnU2VydmVyKSBTdWJtaXRTY2F2ZW5nZShnb0N0eCBjb250ZXh0LkNvbnRleHQsIG1zZyAqdHlwZXMuTXNnU3VibWl0U2NhdmVuZ2UpICgqdHlwZXMuTXNnU3VibWl0U2NhdmVuZ2VSZXNwb25zZSwgZXJyb3IpIHsKICAvLyBnZXQgY29udGV4dCB0aGF0IGNvbnRhaW5zIGluZm9ybWF0aW9uIGFib3V0IHRoZSBlbnZpcm9ubWVudCwgc3VjaCBhcyBibG9jayBoZWlnaHQKCWN0eCA6PSBzZGsuVW53cmFwU0RLQ29udGV4dChnb0N0eCkKICAvLyBjcmVhdGUgYSBuZXcgc2NhdmVuZ2UgZnJvbSB0aGUgZGF0YSBpbiB0aGUgTXNnU3VibWl0U2NhdmVuZ2UgbWVzc2FnZQoJdmFyIHNjYXZlbmdlID0gdHlwZXMuU2NhdmVuZ2V7CgkJSW5kZXg6ICAgICAgICBtc2cuU29sdXRpb25IYXNoLAoJCUNyZWF0b3I6ICAgICAgbXNnLkNyZWF0b3IsCgkJRGVzY3JpcHRpb246ICBtc2cuRGVzY3JpcHRpb24sCgkJU29sdXRpb25IYXNoOiBtc2cuU29sdXRpb25IYXNoLAoJCVJld2FyZDogICAgICAgbXNnLlJld2FyZCwKCX0KICAvLyB0cnkgZ2V0dGluZyBhIHNjYXZlbmdlIGZyb20gdGhlIHN0b3JlIHVzaW5nIHRoZSBzb2x1dGlvbiBoYXNoIGFzIHRoZSBrZXkKCV8sIGlzRm91bmQgOj0gay5HZXRTY2F2ZW5nZShjdHgsIHNjYXZlbmdlLlNvbHV0aW9uSGFzaCkKICAvLyByZXR1cm4gYW4gZXJyb3IgaWYgYSBzY2F2ZW5nZSBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgc3RvcmUKCWlmIGlzRm91bmQgewoJCXJldHVybiBuaWwsIHNka2Vycm9ycy5XcmFwKHNka2Vycm9ycy5FcnJJbnZhbGlkUmVxdWVzdCwgJnF1b3Q7U2NhdmVuZ2Ugd2l0aCB0aGF0IHNvbHV0aW9uIGhhc2ggYWxyZWFkeSBleGlzdHMmcXVvdDspCgl9CiAgLy8gZ2V0IGFkZHJlc3Mgb2YgdGhlIFNjYXZlbmdlIG1vZHVsZSBhY2NvdW50Cgltb2R1bGVBY2N0IDo9IHNkay5BY2NBZGRyZXNzKGNyeXB0by5BZGRyZXNzSGFzaChbXWJ5dGUodHlwZXMuTW9kdWxlTmFtZSkpKQogIC8vIGNvbnZlcnQgdGhlIG1lc3NhZ2UgY3JlYXRvciBhZGRyZXNzIGZyb20gYSBzdHJpbmcgaW50byBzZGsuQWNjQWRkcmVzcwoJc2NhdmVuZ2VyLCBlcnIgOj0gc2RrLkFjY0FkZHJlc3NGcm9tQmVjaDMyKHNjYXZlbmdlLkNyZWF0b3IpCglpZiBlcnIgIT0gbmlsIHsKCQlwYW5pYyhlcnIpCgl9CiAgLy8gY29udmVydCB0b2tlbnMgZnJvbSBzdHJpbmcgaW50byBzZGsuQ29pbnMKCXJld2FyZCwgZXJyIDo9IHNkay5QYXJzZUNvaW5zTm9ybWFsaXplZChzY2F2ZW5nZS5SZXdhcmQpCglpZiBlcnIgIT0gbmlsIHsKCQlwYW5pYyhlcnIpCgl9CiAgLy8gc2VuZCB0b2tlbnMgZnJvbSB0aGUgc2NhdmVuZ2UgY3JlYXRvciB0byB0aGUgbW9kdWxlIGFjY291bnQKCXNka0Vycm9yIDo9IGsuYmFua0tlZXBlci5TZW5kQ29pbnMoY3R4LCBzY2F2ZW5nZXIsIG1vZHVsZUFjY3QsIHJld2FyZCkKCWlmIHNka0Vycm9yICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgc2RrRXJyb3IKCX0KICAvLyB3cml0ZSB0aGUgc2NhdmVuZ2UgdG8gdGhlIHN0b3JlCglrLlNldFNjYXZlbmdlKGN0eCwgc2NhdmVuZ2UpCglyZXR1cm4gJmFtcDt0eXBlcy5Nc2dTdWJtaXRTY2F2ZW5nZVJlc3BvbnNle30sIG5pbAp9Cg=="}}),Z._v(" "),l("p",[Z._v("Notice the use of "),l("code",[Z._v("moduleAcct")]),Z._v(". This account is not controlled by a public key pair, but is a reference to an account that is owned by this actual module. It is used to hold the bounty reward that is attached to a scavenge until that scavenge has been solved, at which point the bounty is paid to the account who solved the scavenge.")]),Z._v(" "),l("p",[l("code",[Z._v("SubmitScavenge")]),Z._v(" uses "),l("code",[Z._v("SendCoins")]),Z._v(" method from the "),l("code",[Z._v("bank")]),Z._v(" module. In the beginning when scaffolding a module you used "),l("code",[Z._v("--dep bank")]),Z._v(" to specify a dependency between the "),l("code",[Z._v("scavenge")]),Z._v(" and "),l("code",[Z._v("bank")]),Z._v(" modules. This created an "),l("code",[Z._v("expected_keepers.go")]),Z._v(" file with a "),l("code",[Z._v("BankKeeper")]),Z._v(" interface. Add "),l("code",[Z._v("SendCoins")]),Z._v(" to be able to use it in the keeper methods of the "),l("code",[Z._v("scavenge")]),Z._v(" module.")]),Z._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9zY2F2ZW5nZS90eXBlcy9leHBlY3RlZF9rZWVwZXJzLmdvCnBhY2thZ2UgdHlwZXMKCmltcG9ydCAoCglzZGsgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcyZxdW90OwopCgp0eXBlIEJhbmtLZWVwZXIgaW50ZXJmYWNlIHsKCVNlbmRDb2lucyhjdHggc2RrLkNvbnRleHQsIGZyb21BZGRyIHNkay5BY2NBZGRyZXNzLCB0b0FkZHIgc2RrLkFjY0FkZHJlc3MsIGFtdCBzZGsuQ29pbnMpIGVycm9yCn0KCg=="}}),Z._v(" "),l("h2",{attrs:{id:"commit-solution"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#commit-solution"}},[Z._v("#")]),Z._v(" Commit Solution")]),Z._v(" "),l("p",[Z._v("Commit solution method should do the following:")]),Z._v(" "),l("ul",[l("li",[Z._v("Check that commit with a given hash doesn't exist in the store")]),Z._v(" "),l("li",[Z._v("Write a new commit to the store")])]),Z._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9zY2F2ZW5nZS9rZWVwZXIvbXNnX3NlcnZlcl9jb21taXRfc29sdXRpb24uZ28KcGFja2FnZSBrZWVwZXIKCmltcG9ydCAoCgkmcXVvdDtjb250ZXh0JnF1b3Q7CgoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb25hdXQvc2NhdmVuZ2UveC9zY2F2ZW5nZS90eXBlcyZxdW90OwoJc2RrICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvdHlwZXMmcXVvdDsKCXNka2Vycm9ycyAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzL2Vycm9ycyZxdW90OwopCgpmdW5jIChrIG1zZ1NlcnZlcikgQ29tbWl0U29sdXRpb24oZ29DdHggY29udGV4dC5Db250ZXh0LCBtc2cgKnR5cGVzLk1zZ0NvbW1pdFNvbHV0aW9uKSAoKnR5cGVzLk1zZ0NvbW1pdFNvbHV0aW9uUmVzcG9uc2UsIGVycm9yKSB7CgljdHggOj0gc2RrLlVud3JhcFNES0NvbnRleHQoZ29DdHgpCiAgLy8gY3JlYXRlIGEgbmV3IGNvbW1pdCBmcm9tIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgTXNnQ29tbWl0U29sdXRpb24gbWVzc2FnZQoJdmFyIGNvbW1pdCA9IHR5cGVzLkNvbW1pdHsKCQlJbmRleDogICAgICAgICAgICAgICAgIG1zZy5Tb2x1dGlvblNjYXZlbmdlckhhc2gsCgkJQ3JlYXRvcjogICAgICAgICAgICAgICBtc2cuQ3JlYXRvciwKCQlTb2x1dGlvbkhhc2g6ICAgICAgICAgIG1zZy5Tb2x1dGlvbkhhc2gsCgkJU29sdXRpb25TY2F2ZW5nZXJIYXNoOiBtc2cuU29sdXRpb25TY2F2ZW5nZXJIYXNoLAoJfQogIC8vIHRyeSBnZXR0aW5nIGEgY29tbWl0IGZyb20gdGhlIHN0b3JlIHVzaW5nIHRoZSBzb2x1dGlvbitzY2F2ZW5nZXIgaGFzaCBhcyB0aGUga2V5CglfLCBpc0ZvdW5kIDo9IGsuR2V0Q29tbWl0KGN0eCwgY29tbWl0LlNvbHV0aW9uU2NhdmVuZ2VySGFzaCkKCS8vIHJldHVybiBhbiBlcnJvciBpZiBhIGNvbW1pdCBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgc3RvcmUKCWlmIGlzRm91bmQgewoJCXJldHVybiBuaWwsIHNka2Vycm9ycy5XcmFwKHNka2Vycm9ycy5FcnJJbnZhbGlkUmVxdWVzdCwgJnF1b3Q7Q29tbWl0IHdpdGggdGhhdCBoYXNoIGFscmVhZHkgZXhpc3RzJnF1b3Q7KQoJfQogIC8vIHdyaXRlIGNvbW1pdCB0byB0aGUgc3RvcmUKCWsuU2V0Q29tbWl0KGN0eCwgY29tbWl0KQoJcmV0dXJuICZhbXA7dHlwZXMuTXNnQ29tbWl0U29sdXRpb25SZXNwb25zZXt9LCBuaWwKfQo="}}),Z._v(" "),l("h2",{attrs:{id:"reveal-solution"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#reveal-solution"}},[Z._v("#")]),Z._v(" Reveal Solution")]),Z._v(" "),l("p",[Z._v("Reveal solution method should do the following:")]),Z._v(" "),l("ul",[l("li",[Z._v("Check that a commit with a given hash exists in the store")]),Z._v(" "),l("li",[Z._v("Check that a scavenge with a given solution hash exists in the store")]),Z._v(" "),l("li",[Z._v("Check that the scavenge hasn't already been solved")]),Z._v(" "),l("li",[Z._v("Send tokens from the module account to the account that revealed the correct anwer")]),Z._v(" "),l("li",[Z._v("Write the updated scavenge to the store")])]),Z._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9zY2F2ZW5nZS9rZWVwZXIvbXNnX3NlcnZlcl9yZXZlYWxfc29sdXRpb24uZ28KcGFja2FnZSBrZWVwZXIKCmltcG9ydCAoCgkmcXVvdDtjb250ZXh0JnF1b3Q7CgkmcXVvdDtjcnlwdG8vc2hhMjU2JnF1b3Q7CgkmcXVvdDtlbmNvZGluZy9oZXgmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2Nvc21vbmF1dC9zY2F2ZW5nZS94L3NjYXZlbmdlL3R5cGVzJnF1b3Q7CglzZGsgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcyZxdW90OwoJc2RrZXJyb3JzICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvdHlwZXMvZXJyb3JzJnF1b3Q7CgoJJnF1b3Q7Z2l0aHViLmNvbS90ZW5kZXJtaW50L3RlbmRlcm1pbnQvY3J5cHRvJnF1b3Q7CikKCmZ1bmMgKGsgbXNnU2VydmVyKSBSZXZlYWxTb2x1dGlvbihnb0N0eCBjb250ZXh0LkNvbnRleHQsIG1zZyAqdHlwZXMuTXNnUmV2ZWFsU29sdXRpb24pICgqdHlwZXMuTXNnUmV2ZWFsU29sdXRpb25SZXNwb25zZSwgZXJyb3IpIHsKCWN0eCA6PSBzZGsuVW53cmFwU0RLQ29udGV4dChnb0N0eCkKICAvLyBjb25jYXRlbmF0ZSBhIHNvbHV0aW9uIGFuZCBhIHNjYXZlbmdlciBhZGRyZXNzIGFuZCBjb252ZXJ0IGl0IHRvIGJ5dGVzCgl2YXIgc29sdXRpb25TY2F2ZW5nZXJCeXRlcyA9IFtdYnl0ZShtc2cuU29sdXRpb24gKyBtc2cuQ3JlYXRvcikKICAvLyBmaW5kIHRoZSBoYXNoIG9mIHNvbHV0aW9uIGFuZCBhZGRyZXNzCgl2YXIgc29sdXRpb25TY2F2ZW5nZXJIYXNoID0gc2hhMjU2LlN1bTI1Nihzb2x1dGlvblNjYXZlbmdlckJ5dGVzKQogIC8vIGNvbnZlcnQgdGhlIGhhc2ggdG8gYSBzdHJpbmcKCXZhciBzb2x1dGlvblNjYXZlbmdlckhhc2hTdHJpbmcgPSBoZXguRW5jb2RlVG9TdHJpbmcoc29sdXRpb25TY2F2ZW5nZXJIYXNoWzpdKQogIC8vIHRyeSBnZXR0aW5nIGEgY29tbWl0IHVzaW5nIHRoZSB0aGUgaGFzaCBvZiBzb2x1dGlvbiBhbmQgYWRkcmVzcwoJXywgaXNGb3VuZCA6PSBrLkdldENvbW1pdChjdHgsIHNvbHV0aW9uU2NhdmVuZ2VySGFzaFN0cmluZykKICAvLyByZXR1cm4gYW4gZXJyb3IgaWYgYSBjb21taXQgZG9lc24ndCBleGlzdAoJaWYgIWlzRm91bmQgewoJCXJldHVybiBuaWwsIHNka2Vycm9ycy5XcmFwKHNka2Vycm9ycy5FcnJJbnZhbGlkUmVxdWVzdCwgJnF1b3Q7Q29tbWl0IHdpdGggdGhhdCBoYXNoIGRvZXNuJ3QgZXhpc3RzJnF1b3Q7KQoJfQogIC8vIGZpbmQgYSBoYXNoIG9mIHRoZSBzb2x1dGlvbgoJdmFyIHNvbHV0aW9uSGFzaCA9IHNoYTI1Ni5TdW0yNTYoW11ieXRlKG1zZy5Tb2x1dGlvbikpCiAgLy8gZW5jb2RlIHRoZSBzb2x1dGlvbiBoYXNoIHRvIHN0cmluZwoJdmFyIHNvbHV0aW9uSGFzaFN0cmluZyA9IGhleC5FbmNvZGVUb1N0cmluZyhzb2x1dGlvbkhhc2hbOl0pCgl2YXIgc2NhdmVuZ2UgdHlwZXMuU2NhdmVuZ2UKICAvLyBnZXQgYSBzY2F2ZW5nZSBmcm9tIHRoZSBzdHJlIHVzaW5nIHRoZSBzb2x1dGlvbiBoYXNoCglzY2F2ZW5nZSwgaXNGb3VuZCA9IGsuR2V0U2NhdmVuZ2UoY3R4LCBzb2x1dGlvbkhhc2hTdHJpbmcpCiAgLy8gcmV0dXJuIGFuIGVycm9yIGlmIHRoZSBzb2x1dGlvbiBkb2Vzbid0IGV4aXN0CglpZiAhaXNGb3VuZCB7CgkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXAoc2RrZXJyb3JzLkVyckludmFsaWRSZXF1ZXN0LCAmcXVvdDtTY2F2ZW5nZSB3aXRoIHRoYXQgc29sdXRpb24gaGFzaCBkb2Vzbid0IGV4aXN0cyZxdW90OykKCX0KICAvLyBjaGVjayB0aGF0IHRoZSBzY2F2ZW5nZXIgcHJvcGVydHkgY29udGFpbnMgYSB2YWxpZCBhZGRyZXNzCglfLCBlcnIgOj0gc2RrLkFjY0FkZHJlc3NGcm9tQmVjaDMyKHNjYXZlbmdlLlNjYXZlbmdlcikKICAvLyByZXR1cm4gYW4gZXJyb3IgaWYgYSBzY2F2ZW5nZSBoYXMgYWxyZWFkeSBiZWVuIHNvbHZlZAoJaWYgZXJyID09IG5pbCB7CgkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXAoc2RrZXJyb3JzLkVyckludmFsaWRSZXF1ZXN0LCAmcXVvdDtTY2F2ZW5nZSBoYXMgYWxyZWFkeSBiZWVuIHNvbHZlZCZxdW90OykKCX0KICAvLyBzYXZlIHRoZSBzY2F2ZWJnZXIgYWRkcmVzcyB0byB0aGUgc2NhdmVuZ2UKCXNjYXZlbmdlLlNjYXZlbmdlciA9IG1zZy5DcmVhdG9yCiAgLy8gc2F2ZSB0aGUgY29ycmVjdCBzb2x1dGlvbiB0byB0aGUgc2NhdmVuZ2UKCXNjYXZlbmdlLlNvbHV0aW9uID0gbXNnLlNvbHV0aW9uCiAgLy8gZ2V0IGFkZHJlc3Mgb2YgdGhlIG1vZHVsZSBhY2NvdW50Cgltb2R1bGVBY2N0IDo9IHNkay5BY2NBZGRyZXNzKGNyeXB0by5BZGRyZXNzSGFzaChbXWJ5dGUodHlwZXMuTW9kdWxlTmFtZSkpKQogIC8vIGNvbnZlcnQgc2NhdmVuZ2VyIGFkZHJlc3MgZnJvbSBzdHJpbmcgdG8gc2RrLkFjY0FkZHJlc3MKCXNjYXZlbmdlciwgZXJyIDo9IHNkay5BY2NBZGRyZXNzRnJvbUJlY2gzMihzY2F2ZW5nZS5TY2F2ZW5nZXIpCglpZiBlcnIgIT0gbmlsIHsKCQlwYW5pYyhlcnIpCgl9CiAgLy8gcGFyc2UgdG9rZW5zIGZyb20gYSBzdHJpbmcgdG8gc2RrLkNvaW5zCglyZXdhcmQsIGVyciA6PSBzZGsuUGFyc2VDb2luc05vcm1hbGl6ZWQoc2NhdmVuZ2UuUmV3YXJkKQoJaWYgZXJyICE9IG5pbCB7CgkJcGFuaWMoZXJyKQoJfQogIC8vIHNlbmQgdG9rZW5zIGZyb20gYSBtb2R1bGUgYWNjb3VudCB0byB0aGUgc2NhdmVuZ2VyCglzZGtFcnJvciA6PSBrLmJhbmtLZWVwZXIuU2VuZENvaW5zKGN0eCwgbW9kdWxlQWNjdCwgc2NhdmVuZ2VyLCByZXdhcmQpCglpZiBzZGtFcnJvciAhPSBuaWwgewoJCXJldHVybiBuaWwsIHNka0Vycm9yCgl9CiAgLy8gc2F2ZSB0aGUgdWRwYXRlZCBzY2F2ZW5nZSB0byB0aGUgc3RvcmUKCWsuU2V0U2NhdmVuZ2UoY3R4LCBzY2F2ZW5nZSkKCXJldHVybiAmYW1wO3R5cGVzLk1zZ1JldmVhbFNvbHV0aW9uUmVzcG9uc2V7fSwgbmlsCn0K"}})],1)}),[],!1,null,null,null);c.default=d.exports}}]);