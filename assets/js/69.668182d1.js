(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{669:function(e,t,o){"use strict";o.r(t);var a=o(0),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("hr"),e._v(" "),o("p",[e._v('❗ This tutorial uses the Cosmos SDK v0.39 as "Launchpad" LTS. Cosmos SDK v0.40 has been released in January 2021 and contains major upgrades and new features. v0.39 is for all projects prior this date. When you start newly, it is recommended to use v0.40 '),o("RouterLink",{attrs:{to:"/blog/tutorial/"}},[e._v("here")]),e._v(". Learn more about it "),o("a",{attrs:{href:"https://blog.cosmos.network/launchpad-a-pre-stargate-stable-version-of-the-cosmos-sdk-e0c58d8c4e24",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),o("OutboundLink")],1),e._v(".")],1),e._v(" "),o("hr"),e._v(" "),o("h1",{attrs:{id:"create-posts"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#create-posts"}},[e._v("#")]),e._v(" Create posts")]),e._v(" "),o("p",[e._v("By following this beginner tutorial, you will end up with a simple blog app that is powered by the Cosmos SDK.")]),e._v(" "),o("h2",{attrs:{id:"requirements"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[e._v("#")]),e._v(" Requirements")]),e._v(" "),o("p",[e._v("For this tutorial we will be using "),o("a",{attrs:{href:"https://github.com/tendermint/starport",target:"_blank",rel:"noopener noreferrer"}},[e._v("Starport"),o("OutboundLink")],1),e._v(" v0.13.1, an easy to use tool for building blockchains. To install "),o("code",[e._v("starport")]),e._v(" into "),o("code",[e._v("/usr/local/bin")]),e._v(", run the following command:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"Y3VybCBodHRwczovL2dldC5zdGFycG9ydC5uZXR3b3JrL3N0YXJwb3J0QHYwLjEzLjEhIHwgYmFzaAo="}}),e._v(" "),o("p",[e._v("You can also use Starport v0.13.1 on the web in a "),o("a",{attrs:{href:"http://gitpod.io/#https://github.com/tendermint/starport/tree/v0.13.1",target:"_blank",rel:"noopener noreferrer"}},[e._v("browser-based IDE"),o("OutboundLink")],1),e._v(". Learn more about other ways to "),o("a",{attrs:{href:"https://github.com/tendermint/starport/blob/develop/docs/1%20Introduction/2%20Install.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("install Starport"),o("OutboundLink")],1),e._v(".")]),e._v(" "),o("h2",{attrs:{id:"getting-started"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[e._v("#")]),e._v(" Getting Started")]),e._v(" "),o("p",[e._v("Let's get started! The first step is to "),o("a",{attrs:{href:"https://github.com/tendermint/starport",target:"_blank",rel:"noopener noreferrer"}},[e._v("install the "),o("code",[e._v("starport")]),o("OutboundLink")],1),e._v(" CLI tool.")]),e._v(" "),o("p",[e._v("After "),o("code",[e._v("starport")]),e._v(" is installed, use it to create the initial app structure inside a directory named "),o("code",[e._v("blog")]),e._v(":")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"c3RhcnBvcnQgYXBwIGdpdGh1Yi5jb20vZXhhbXBsZS9ibG9nIC0tc2RrLXZlcnNpb24gbGF1bmNocGFkCg=="}}),e._v(" "),o("p",[e._v("One of the main features of Starport is code generation. The command above has generated a directory structure with a working blockchain application. Starport can also add data types to your app with "),o("code",[e._v("starport type")]),e._v(" command. To see it in action, follow the poll application tutorial. In this guide, however, we'll create those files manually to understand how it all works under the hood.")]),e._v(" "),o("h2",{attrs:{id:"overview"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),o("p",[e._v("Let's take a quick look at what Starport has generated for us. "),o("a",{attrs:{href:"https://docs.cosmos.network/master/basics/app-anatomy.html#core-application-file",target:"_blank",rel:"noopener noreferrer"}},[o("code",[e._v("app/app.go")]),o("OutboundLink")],1),e._v(" file imports and configures SDK modules and creates a constructor for our application that extends a "),o("a",{attrs:{href:"https://docs.cosmos.network/master/core/baseapp.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("basic SDK application"),o("OutboundLink")],1),e._v(" among other things. This app will use only a couple standard modules bundled with Cosmos SDK (including "),o("code",[e._v("auth")]),e._v(" for dealing with accounts and "),o("code",[e._v("bank")]),e._v(" for handling coin transfers) and one module ("),o("code",[e._v("x/blog")]),e._v(") that will contain custom functionality.")]),e._v(" "),o("p",[e._v("In "),o("code",[e._v("cmd")]),e._v(" directory we have source files of two programs for interacting with our application: "),o("code",[e._v("blogd")]),e._v(" starts a full-node for your blockchain and "),o("code",[e._v("blogcli")]),e._v(" enables you to query the full-node, either to update the state by sending a transaction or to read it via a query.")]),e._v(" "),o("p",[e._v("This blog app will store data in a persistent "),o("a",{attrs:{href:"https://docs.cosmos.network/master/core/store.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("key-value store"),o("OutboundLink")],1),e._v(". Similarly to most key-value stores, you can retrieve, delete, update, and loop through keys to obtain the values you are interested in.")]),e._v(" "),o("p",[e._v("We’ll be creating a simple blog-like application, so let’s define the first type, the "),o("code",[e._v("Post")]),e._v(".")]),e._v(" "),o("h2",{attrs:{id:"x-blog-types-typespost-go"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#x-blog-types-typespost-go"}},[e._v("#")]),e._v(" x/blog/types/TypesPost.go")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSB0eXBlcwoKaW1wb3J0ICgKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CikKCnR5cGUgUG9zdCBzdHJ1Y3QgewoJQ3JlYXRvciBzZGsuQWNjQWRkcmVzcyBganNvbjomcXVvdDtjcmVhdG9yJnF1b3Q7IHlhbWw6JnF1b3Q7Y3JlYXRvciZxdW90O2AKCUlEICAgICAgc3RyaW5nICAgICAgICAgYGpzb246JnF1b3Q7aWQmcXVvdDsgeWFtbDomcXVvdDtpZCZxdW90O2AKCVRpdGxlICAgc3RyaW5nICAgICAgICAgYGpzb246JnF1b3Q7dGl0bGUmcXVvdDsgeWFtbDomcXVvdDt0aXRsZSZxdW90O2AKCUJvZHkgICAgc3RyaW5nICAgICAgICAgYGpzb246JnF1b3Q7Ym9keSZxdW90OyB5YW1sOiZxdW90O2JvZHkmcXVvdDtgCn0KCg=="}}),e._v(" "),o("p",[e._v("The code above defines the three properties of a post: Creator, Title and ID. The SDK provides useful types to represent things like addresses, so we use "),o("code",[e._v("sdk.AccAddress")]),e._v(" for Creator. A Title is stored as a string. Lastly, we generate unique global IDs for each post and also store them as strings.")]),e._v(" "),o("p",[e._v("Posts in our key-value store will look like this:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"JnF1b3Q7cG9zdC0wYmFlOWY3ZC0yMGY4LTRiNTEtOWQ1Yy1hZjkxMDMxNzdkNjYmcXVvdDs6IHsKICAmcXVvdDtDcmVhdG9yJnF1b3Q7OiAmcXVvdDtjb3Ntb3MxOGNkNXQ0bXN2cDJscHV2aDk5cndnbHJtanJydzlxeDVoM2YzZ3omcXVvdDssCiAgJnF1b3Q7VGl0bGUmcXVvdDs6ICZxdW90O1RoaXMgaXMgYSBwb3N0ISZxdW90OywKICAmcXVvdDtCb2R5JnF1b3Q7OiAmcXVvdDtXZWxjb21lIHRvIG15IGJsb2cgYXBwLiZxdW90OywKICAmcXVvdDtJRCZxdW90OzogJnF1b3Q7MGJhZTlmN2QtMjBmOC00YjUxLTlkNWMtYWY5MTAzMTc3ZDY2JnF1b3Q7Cn0sCiZxdW90O3Bvc3QtOGM2ZDhjZDQtYjRjOS00YmEzLWE2ODMtZTg5NGRiM2YyNjA1JnF1b3Q7OiB7CiAgLi4uCn0K"}}),e._v(" "),o("p",[e._v("Right now the store is empty. Let's figure out how to add posts.")]),e._v(" "),o("p",[e._v("With the Cosmos SDK, users can interact with your app with either a CLI ("),o("code",[e._v("blogcli")]),e._v(") or by sending HTTP requests. Let's define the CLI command first. Users should be able to type "),o("code",[e._v("blogcli tx blog create-post 'This is a post!' 'Welcome to my blog app.' --from=user1")]),e._v(" to add a post to your store. The "),o("code",[e._v("create-post")]),e._v(" subcommand hasn’t been defined yet--let’s do it now.")]),e._v(" "),o("h2",{attrs:{id:"x-blog-client-cli-tx-go"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#x-blog-client-cli-tx-go"}},[e._v("#")]),e._v(" x/blog/client/cli/tx.go")]),e._v(" "),o("p",[e._v("In the "),o("code",[e._v("import")]),e._v(" block, make sure to import these five additional packages:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKICAvLyBFeGlzdGluZyBpbXBvcnRzLi4uCiAgJnF1b3Q7YnVmaW8mcXVvdDsKICAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL2NsaWVudC9jb250ZXh0JnF1b3Q7CiAgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay94L2F1dGgmcXVvdDsKICAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3gvYXV0aC9jbGllbnQvdXRpbHMmcXVvdDsKICBzZGsgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcyZxdW90OwopCg=="}}),e._v(" "),o("p",[e._v("This file already contains "),o("code",[e._v("func GetTxCmd")]),e._v(" which defines custom "),o("code",[e._v("blogcli")]),e._v(" "),o("a",{attrs:{href:"https://docs.cosmos.network/master/building-modules/module-interfaces.html#cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("commands"),o("OutboundLink")],1),e._v(". We will add the custom "),o("code",[e._v("create-post")]),e._v(" command to our "),o("code",[e._v("blogcli")]),e._v(" by first adding "),o("code",[e._v("GetCmdCreatePost")]),e._v(" to "),o("code",[e._v("blogTxCmd")]),e._v(".")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ICBibG9nVHhDbWQuQWRkQ29tbWFuZChmbGFncy5Qb3N0Q29tbWFuZHMoCiAgICBHZXRDbWRDcmVhdGVQb3N0KGNkYyksCiAgKS4uLikK"}}),e._v(" "),o("p",[e._v("At the end of the file, let's define "),o("code",[e._v("GetCmdCreatePost")]),e._v(" itself.")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBHZXRDbWRDcmVhdGVQb3N0KGNkYyAqY29kZWMuQ29kZWMpICpjb2JyYS5Db21tYW5kIHsKCXJldHVybiAmYW1wO2NvYnJhLkNvbW1hbmR7CgkJVXNlOiAgICZxdW90O2NyZWF0ZS1wb3N0IFt0aXRsZV0gW2JvZHldJnF1b3Q7LAoJCVNob3J0OiAmcXVvdDtDcmVhdGVzIGEgbmV3IHBvc3QmcXVvdDssCgkJQXJnczogIGNvYnJhLk1pbmltdW1OQXJncygyKSwKCQlSdW5FOiBmdW5jKGNtZCAqY29icmEuQ29tbWFuZCwgYXJncyBbXXN0cmluZykgZXJyb3IgewogICAgICBhcmdzVGl0bGUgOj0gc3RyaW5nKGFyZ3NbMF0pCiAgICAgIGFyZ3NCb2R5IDo9IHN0cmluZyhhcmdzWzFdKQogICAgICAKCQkJY2xpQ3R4IDo9IGNvbnRleHQuTmV3Q0xJQ29udGV4dCgpLldpdGhDb2RlYyhjZGMpCgkJCWluQnVmIDo9IGJ1ZmlvLk5ld1JlYWRlcihjbWQuSW5PclN0ZGluKCkpCgkJCXR4QmxkciA6PSBhdXRoLk5ld1R4QnVpbGRlckZyb21DTEkoaW5CdWYpLldpdGhUeEVuY29kZXIodXRpbHMuR2V0VHhFbmNvZGVyKGNkYykpCgkJCW1zZyA6PSB0eXBlcy5OZXdNc2dDcmVhdGVQb3N0KGNsaUN0eC5HZXRGcm9tQWRkcmVzcygpLCBhcmdzVGl0bGUsIGFyZ3NCb2R5KQoJCQllcnIgOj0gbXNnLlZhbGlkYXRlQmFzaWMoKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoJCQlyZXR1cm4gdXRpbHMuR2VuZXJhdGVPckJyb2FkY2FzdE1zZ3MoY2xpQ3R4LCB0eEJsZHIsIFtdc2RrLk1zZ3ttc2d9KQoJCX0sCgl9Cn0KCg=="}}),e._v(" "),o("p",[e._v("The function above defines what happens when you run the "),o("code",[e._v("create-post")]),e._v(" subcommand. "),o("code",[e._v("create-post")]),e._v(" takes two arguments "),o("code",[e._v("[title] [body]")]),e._v(", creates a message "),o("code",[e._v("NewMsgCreatePost")]),e._v(" (with title as "),o("code",[e._v("args[0]")]),e._v(" and "),o("code",[e._v("args[1]")]),e._v(") and broadcasts this message to be processed in your application.")]),e._v(" "),o("p",[e._v("This is a common pattern in the SDK: users make changes to the store by broadcasting "),o("a",{attrs:{href:"https://docs.cosmos.network/master/building-modules/messages-and-queries.html#messages",target:"_blank",rel:"noopener noreferrer"}},[e._v("messages"),o("OutboundLink")],1),e._v(". Both CLI commands and HTTP requests create messages that can be broadcasted in order for state transition to occur.")]),e._v(" "),o("h2",{attrs:{id:"x-blog-types-msgcreatepost-go"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#x-blog-types-msgcreatepost-go"}},[e._v("#")]),e._v(" x/blog/types/MsgCreatePost.go")]),e._v(" "),o("p",[e._v("Let’s define "),o("code",[e._v("NewMsgCreatePost")]),e._v(" in a new file you should create as "),o("code",[e._v("x/blog/types/MsgCreatePost.go")]),e._v(".")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSB0eXBlcwoKaW1wb3J0ICgKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCSZxdW90O2dpdGh1Yi5jb20vZ29vZ2xlL3V1aWQmcXVvdDsKKQoKdmFyIF8gc2RrLk1zZyA9ICZhbXA7TXNnQ3JlYXRlUG9zdHt9Cgp0eXBlIE1zZ0NyZWF0ZVBvc3Qgc3RydWN0IHsKICBJRCAgICAgIHN0cmluZwogIENyZWF0b3Igc2RrLkFjY0FkZHJlc3MgYGpzb246JnF1b3Q7Y3JlYXRvciZxdW90OyB5YW1sOiZxdW90O2NyZWF0b3ImcXVvdDtgCiAgVGl0bGUgc3RyaW5nIGBqc29uOiZxdW90O3RpdGxlJnF1b3Q7IHlhbWw6JnF1b3Q7dGl0bGUmcXVvdDtgCiAgQm9keSBzdHJpbmcgYGpzb246JnF1b3Q7Ym9keSZxdW90OyB5YW1sOiZxdW90O2JvZHkmcXVvdDtgCn0K"}}),e._v(" "),o("p",[e._v("Similarly to the post struct, "),o("code",[e._v("MsgCreatePost")]),e._v(" contains creator and title properties. We don’t include ID property, because "),o("code",[e._v("MsgCreatePost")]),e._v(" defines only the data we accept from the user—we will be generating ID automatically on the next step.")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gTmV3TXNnQ3JlYXRlUG9zdCBjcmVhdGVzIHRoZSBgTXNnQ3JlYXRlUG9zdGAgbWVzc2FnZQpmdW5jIE5ld01zZ0NyZWF0ZVBvc3QoY3JlYXRvciBzZGsuQWNjQWRkcmVzcywgdGl0bGUgc3RyaW5nLCBib2R5IHN0cmluZykgTXNnQ3JlYXRlUG9zdCB7CiAgcmV0dXJuIE1zZ0NyZWF0ZVBvc3R7CiAgICBJRDogdXVpZC5OZXcoKS5TdHJpbmcoKSwKCQlDcmVhdG9yOiBjcmVhdG9yLAogICAgVGl0bGU6IHRpdGxlLAogICAgQm9keTogYm9keSwKCX0KfQo="}}),e._v(" "),o("p",[o("code",[e._v("NewMsgCreatePost")]),e._v(" is a constructor function that creates the "),o("code",[e._v("MsgCreatePost")]),e._v(" message. The following five functions have to be defined to implement the "),o("code",[e._v("Msg")]),e._v(" interface. They allow you to perform validation that doesn’t require access to the store (like checking for empty values), etc.")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gUm91dGUgLi4uCmZ1bmMgKG1zZyBNc2dDcmVhdGVQb3N0KSBSb3V0ZSgpIHN0cmluZyB7CiAgcmV0dXJuIFJvdXRlcktleQp9Ci8vIFR5cGUgLi4uCmZ1bmMgKG1zZyBNc2dDcmVhdGVQb3N0KSBUeXBlKCkgc3RyaW5nIHsKICByZXR1cm4gJnF1b3Q7Q3JlYXRlUG9zdCZxdW90Owp9Ci8vIEdldFNpZ25lcnMgLi4uCmZ1bmMgKG1zZyBNc2dDcmVhdGVQb3N0KSBHZXRTaWduZXJzKCkgW11zZGsuQWNjQWRkcmVzcyB7CiAgcmV0dXJuIFtdc2RrLkFjY0FkZHJlc3N7c2RrLkFjY0FkZHJlc3MobXNnLkNyZWF0b3IpfQp9Ci8vIEdldFNpZ25CeXRlcyAuLi4KZnVuYyAobXNnIE1zZ0NyZWF0ZVBvc3QpIEdldFNpZ25CeXRlcygpIFtdYnl0ZSB7CiAgYnogOj0gTW9kdWxlQ2RjLk11c3RNYXJzaGFsSlNPTihtc2cpCiAgcmV0dXJuIHNkay5NdXN0U29ydEpTT04oYnopCn0KLy8gVmFsaWRhdGVCYXNpYyAuLi4KZnVuYyAobXNnIE1zZ0NyZWF0ZVBvc3QpIFZhbGlkYXRlQmFzaWMoKSBlcnJvciB7CiAgaWYgbXNnLkNyZWF0b3IuRW1wdHkoKSB7CiAgICByZXR1cm4gc2RrZXJyb3JzLldyYXAoc2RrZXJyb3JzLkVyckludmFsaWRBZGRyZXNzLCAmcXVvdDtjcmVhdG9yIGNhbid0IGJlIGVtcHR5JnF1b3Q7KQogIH0KICByZXR1cm4gbmlsCn0K"}}),e._v(" "),o("p",[e._v("Going back to "),o("code",[e._v("GetCmdCreatePost")]),e._v(" in "),o("code",[e._v("x/blog/client/cli/tx.go")]),e._v(", you'll see "),o("code",[e._v("MsgCreatePost")]),e._v(" being created and broadcast with "),o("code",[e._v("GenerateOrBroadcastMsgs")]),e._v(".")]),e._v(" "),o("p",[e._v("After being broadcast, the messages are processed by an important part of the application, called "),o("a",{attrs:{href:"https://docs.cosmos.network/v0.39/building-modules/handler.html",target:"_blank",rel:"noopener noreferrer"}},[o("strong",[e._v("handlers")]),o("OutboundLink")],1),e._v(".")]),e._v(" "),o("h2",{attrs:{id:"x-blog-handler-go"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#x-blog-handler-go"}},[e._v("#")]),e._v(" x/blog/handler.go")]),e._v(" "),o("p",[e._v("You should already have "),o("code",[e._v("func NewHandler")]),e._v(" defined which lists all available handlers. Modify it to include a new function called "),o("code",[e._v("handleMsgCreatePost")]),e._v(".")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ICAgIHN3aXRjaCBtc2cgOj0gbXNnLih0eXBlKSB7CiAgICBjYXNlIHR5cGVzLk1zZ0NyZWF0ZVBvc3Q6CiAgICAgIHJldHVybiBoYW5kbGVNc2dDcmVhdGVQb3N0KGN0eCwgaywgbXNnKQogICAgZGVmYXVsdDoK"}}),e._v(" "),o("p",[e._v("Now let’s define "),o("code",[e._v("handleMsgCreatePost")]),e._v(":")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBoYW5kbGVNc2dDcmVhdGVQb3N0KGN0eCBzZGsuQ29udGV4dCwgayBrZWVwZXIuS2VlcGVyLCBtc2cgdHlwZXMuTXNnQ3JlYXRlUG9zdCkgKCpzZGsuUmVzdWx0LCBlcnJvcikgewoJdmFyIHBvc3QgPSB0eXBlcy5Qb3N0ewoJCUNyZWF0b3I6IG1zZy5DcmVhdG9yLAoJCUlEOiAgICAgIG1zZy5JRCwKCQlUaXRsZTogICBtc2cuVGl0bGUsCgkJQm9keTogICAgbXNnLkJvZHksCgl9CglrLkNyZWF0ZVBvc3QoY3R4LCBwb3N0KQoKCXJldHVybiAmYW1wO3Nkay5SZXN1bHR7RXZlbnRzOiBjdHguRXZlbnRNYW5hZ2VyKCkuRXZlbnRzKCl9LCBuaWwKfQoK"}}),e._v(" "),o("p",[e._v("In this handler you create a "),o("code",[e._v("Post")]),e._v(" object (post type was defined in the very first step). You populate the post object with creator, title, and body from the message ("),o("code",[e._v("msg.Creator")]),e._v(", "),o("code",[e._v("msg.Title")]),e._v(", and "),o("code",[e._v("msg.Body")]),e._v(") and use the unique ID that was generated in "),o("code",[e._v("tx.go")]),e._v(" with "),o("code",[e._v("NewMsgCreatePost()")]),e._v(" using "),o("code",[e._v("uuid.New().String()")]),e._v(".")]),e._v(" "),o("p",[e._v("After creating a post object with creator, ID and title, the message handler calls "),o("code",[e._v("k.CreatePost(ctx, post)")]),e._v(". “k” stands for "),o("a",{attrs:{href:"https://docs.cosmos.network/master/building-modules/keeper.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Keeper"),o("OutboundLink")],1),e._v(", an abstraction used by the SDK that writes data to the store. Let’s define the "),o("code",[e._v("CreatePost")]),e._v(" keeper function in a new "),o("code",[e._v("keeper/post.go")]),e._v(" file.")]),e._v(" "),o("h2",{attrs:{id:"x-blog-keeper-post-go"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#x-blog-keeper-post-go"}},[e._v("#")]),e._v(" x/blog/keeper/post.go")]),e._v(" "),o("p",[e._v("Add a "),o("code",[e._v("CreatePost")]),e._v(" function that takes two arguments: a "),o("a",{attrs:{href:"https://docs.cosmos.network/master/core/context.html#context-definition",target:"_blank",rel:"noopener noreferrer"}},[e._v("context"),o("OutboundLink")],1),e._v(" and a post.")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBrZWVwZXIKCmltcG9ydCAoCglzZGsgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcyZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9leGFtcGxlL2Jsb2cveC9ibG9nL3R5cGVzJnF1b3Q7CikKCmZ1bmMgKGsgS2VlcGVyKSBDcmVhdGVQb3N0KGN0eCBzZGsuQ29udGV4dCwgcG9zdCB0eXBlcy5Qb3N0KSB7CglzdG9yZSA6PSBjdHguS1ZTdG9yZShrLnN0b3JlS2V5KQoJa2V5IDo9IFtdYnl0ZSh0eXBlcy5Qb3N0UHJlZml4ICsgcG9zdC5JRCkKCXZhbHVlIDo9IGsuY2RjLk11c3RNYXJzaGFsQmluYXJ5TGVuZ3RoUHJlZml4ZWQocG9zdCkKCXN0b3JlLlNldChrZXksIHZhbHVlKQp9Cgo="}}),e._v(" "),o("p",[o("code",[e._v("CreatePost")]),e._v(" creates a key by concatenating a post prefix with an ID. If you look back at how our store looks, you’ll notice keys have prefixes, which is why "),o("code",[e._v("post-0bae9f7d-20f8-4b51-9d5c-af9103177d66")]),e._v(" contained the prefix "),o("code",[e._v("post-")]),e._v(" . The reason for this is you have one store, but you might want to keep different types of objects in it, like posts and users. Prefixing keys with "),o("code",[e._v("post-")]),e._v(" and "),o("code",[e._v("user-")]),e._v(" allows you to share one storage space between different types of objects.")]),e._v(" "),o("h2",{attrs:{id:"x-blog-types-key-go"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#x-blog-types-key-go"}},[e._v("#")]),e._v(" x/blog/types/key.go")]),e._v(" "),o("p",[e._v("To define the post prefix add the following code:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSB0eXBlcwoKY29uc3QgKAogIC8vIE90aGVyIGNvbnN0YW50cy4uLgogIC8vIFBvc3RQcmVmaXggaXMgdXNlZCBmb3Iga2V5cyBpbiB0aGUgS1Ygc3RvcmUKICBQb3N0UHJlZml4ID0gJnF1b3Q7cG9zdC0mcXVvdDsKKQo="}}),e._v(" "),o("h2",{attrs:{id:"x-blog-types-codec-go"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#x-blog-types-codec-go"}},[e._v("#")]),e._v(" x/blog/types/codec.go")]),e._v(" "),o("p",[e._v("Finally, "),o("code",[e._v("store.Set(key, value)")]),e._v(" writes our post to the store.\nTwo last things to do is tell our "),o("a",{attrs:{href:"https://docs.cosmos.network/master/core/encoding.html#amino",target:"_blank",rel:"noopener noreferrer"}},[e._v("encoder"),o("OutboundLink")],1),e._v(" how our "),o("code",[e._v("MsgCreatePost")]),e._v(" is converted to bytes.")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBSZWdpc3RlckNvZGVjKGNkYyAqY29kZWMuQ29kZWMpIHsKICBjZGMuUmVnaXN0ZXJDb25jcmV0ZShNc2dDcmVhdGVQb3N0e30sICZxdW90O2Jsb2cvQ3JlYXRlUG9zdCZxdW90OywgbmlsKQp9Cg=="}}),e._v(" "),o("h2",{attrs:{id:"launch"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#launch"}},[e._v("#")]),e._v(" Launch")]),e._v(" "),o("p",[e._v("Now we are ready to build and start our app and create some posts.")]),e._v(" "),o("p",[e._v("To launch your application run:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"c3RhcnBvcnQgc2VydmUK"}}),e._v(" "),o("p",[e._v("This command installs dependencies, builds and initializes the app, and runs servers. You can also do it manually:")]),e._v(" "),o("ol",[o("li",[o("code",[e._v("go mod tidy")]),e._v(" cleans up dependencies.")]),e._v(" "),o("li",[o("code",[e._v("make")]),e._v(" builds your app and creates two binaries in your go path: "),o("code",[e._v("blogd")]),e._v(" and "),o("code",[e._v("blogcli")]),e._v(".")]),e._v(" "),o("li",[e._v("Initialization scripts in the "),o("code",[e._v("Makefile")]),e._v(" removes data directories, configures your app and generates two accounts. By default your app stores data in your home directory in "),o("code",[e._v("~/.blogd")]),e._v(" and "),o("code",[e._v("~/.blogcli")]),e._v(". The script removes them, so every time you have a clean state.")]),e._v(" "),o("li",[o("code",[e._v("blogd start")]),e._v(" launches your app. After a couple of seconds you will see hashes of blocks being generated. Leave this terminal window open and open a new one.")])]),e._v(" "),o("p",[e._v("Note: depending on your OS and firewall settings, you may have to accept a prompt asking if your application's binary ("),o("code",[e._v("blogd")]),e._v(" in this case) can accept external connections.")]),e._v(" "),o("p",[e._v("Run the following command to create a post:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"YmxvZ2NsaSB0eCBibG9nIGNyZWF0ZS1wb3N0ICZxdW90O015IGZpcnN0IHBvc3QmcXVvdDsgJnF1b3Q7VGhpcyBpcyBhIHBvc3RcISZxdW90OyAtLWZyb209dXNlcjEK"}}),e._v(" "),o("p",[e._v("“This is a post!” is a title for our post and "),o("code",[e._v("--from=user1")]),e._v(" tells the program who is creating this post. "),o("code",[e._v("user1")]),e._v(" is a label for your pair of keys used to sign the transaction, created by the initialization script located within the "),o("code",[e._v("/Makefile")]),e._v(" previously. Keys are stored in "),o("code",[e._v("~/.blogcli")]),e._v(".")]),e._v(" "),o("p",[e._v("After running the command and confirming it, you will see an object with “txhash” property with a value like "),o("code",[e._v("CA1491B39384A4F29E568F62B156E0F2D0601507EF499CE1B8F3930BAFE7F03C")]),e._v(".")]),e._v(" "),o("p",[e._v("To verify that the transaction has been processed, open a browser and visit the following URL (make sure to replace "),o("code",[e._v("CA14...")]),e._v(" with the value of your txhash but make sure to keep the "),o("code",[e._v("0x")]),e._v(" prefix):")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"aHR0cDovL2xvY2FsaG9zdDoyNjY1Ny90eD9oYXNoPTB4Q0ExNDkxQjM5Mzg0QTRGMjlFNTY4RjYyQjE1NkUwRjJEMDYwMTUwN0VGNDk5Q0UxQjhGMzkzMEJBRkU3RjAzQwo="}}),e._v(" "),o("p",[e._v("Congratulations! You have just created and launched your custom blockchain and sent the first transaction 🎉")]),e._v(" "),o("h2",{attrs:{id:"errors"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#errors"}},[e._v("#")]),e._v(" Errors")]),e._v(" "),o("h3",{attrs:{id:"cannot-find-module-providing-package"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cannot-find-module-providing-package"}},[e._v("#")]),e._v(" Cannot find module providing package")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"eC9ibG9nL2NsaWVudC9jbGkvdHguZ286MTI6MjogY2Fubm90IGZpbmQgbW9kdWxlIHByb3ZpZGluZyBwYWNrYWdlIGdpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvY2xpZW50L3V0aWxzOiBpbXBvcnQgbG9va3VwIGRpc2FibGVkIGJ5IC1tb2Q9cmVhZG9ubHkKeC9ibG9nL2NsaWVudC9jbGkvdHguZ286NzU6NTk6IHVuZGVmaW5lZDogc2RrCg=="}}),e._v(" "),o("p",[e._v("Make sure you import all required packages in x/blog/client/cli/tx.go:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKICAvLyAuLi4KICBzZGsgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcyZxdW90OwogICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsveC9hdXRoL2NsaWVudC91dGlscyZxdW90OwopCg=="}}),e._v(" "),o("h3",{attrs:{id:"unknown-command-create-post-for-blog"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#unknown-command-create-post-for-blog"}},[e._v("#")]),e._v(' Unknown command "create-post" for "blog"')]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"YmxvZ2NsaSB0eCBibG9nIGNyZWF0ZS1wb3N0ICdIZWxsbyEnICdNeSBmaXJzdCBwb3N0JyAtLWZyb209dXNlcjEKRVJST1I6IHVua25vd24gY29tbWFuZCAmcXVvdDtjcmVhdGUtcG9zdCZxdW90OyBmb3IgJnF1b3Q7YmxvZyZxdW90Owo="}}),e._v(" "),o("p",[e._v("Make sure you’ve added "),o("code",[e._v("GetCmdCreatePost(cdc)")]),e._v(", to "),o("code",[e._v("func GetTxCmd")]),e._v(" in "),o("code",[e._v("x/blog/client/cli/tx.go")]),e._v(".")]),e._v(" "),o("h3",{attrs:{id:"cannot-encode-unregistered-concrete-type"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cannot-encode-unregistered-concrete-type"}},[e._v("#")]),e._v(" Cannot encode unregistered concrete type")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"YmxvZ2NsaSB0eCBibG9nIGNyZWF0ZS1wb3N0IEhlbGxvISAtLWZyb209dXNlcjEKcGFuaWM6IENhbm5vdCBlbmNvZGUgdW5yZWdpc3RlcmVkIGNvbmNyZXRlIHR5cGUgdHlwZXMuTXNnQ3JlYXRlUG9zdC4K"}}),e._v(" "),o("p",[e._v("Make sure you’ve added "),o("code",[e._v('cdc.RegisterConcrete(MsgCreatePost{}, "blog/CreatePost", nil)')]),e._v(" to "),o("code",[e._v("func RegisterCodec")]),e._v(" in "),o("code",[e._v("x/blog/types/codec.go")]),e._v(".")])],1)}),[],!1,null,null,null);t.default=s.exports}}]);