(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{613:function(e,c,t){"use strict";t.r(c);var d=t(0),o=Object(d.a)({},(function(){var e=this,c=e.$createElement,t=e._self._c||c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"list-posts"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#list-posts"}},[e._v("#")]),e._v(" List posts")]),e._v(" "),t("p",[e._v("To list created posts we will be using "),t("code",[e._v("blogd query blog list-post")]),e._v(" and "),t("code",[e._v("blogd query blog get-post")]),e._v(" command. The "),t("code",[e._v("list-post")]),e._v(" and "),t("code",[e._v("get-post")]),e._v(" subcommands haven’t been defined yet, so let’s do it now. "),t("a",{attrs:{href:"https://docs.cosmos.network/master/building-modules/querier.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Query commands"),t("OutboundLink")],1),e._v(" from the CLI are handled by "),t("code",[e._v("query.go")]),e._v(".")]),e._v(" "),t("p",[e._v("First we define our proto files, in "),t("code",[e._v("proto/blog")])]),e._v(" "),t("h2",{attrs:{id:"add-the-query-proto-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-the-query-proto-file"}},[e._v("#")]),e._v(" Add the Query Proto File")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"proto",base64:"Ly8gcHJvdG8vYmxvZy9xdWVyeS5wcm90bwpzeW50YXggPSAmcXVvdDtwcm90bzMmcXVvdDs7CnBhY2thZ2UgZXhhbXBsZS5ibG9nLmJsb2c7CgppbXBvcnQgJnF1b3Q7Z29vZ2xlL2FwaS9hbm5vdGF0aW9ucy5wcm90byZxdW90OzsKaW1wb3J0ICZxdW90O2Nvc21vcy9iYXNlL3F1ZXJ5L3YxYmV0YTEvcGFnaW5hdGlvbi5wcm90byZxdW90OzsKLy8gdGhpcyBsaW5lIGlzIHVzZWQgYnkgc3RhcnBvcnQgc2NhZmZvbGRpbmcgIyAxCmltcG9ydCAmcXVvdDtibG9nL3Bvc3QucHJvdG8mcXVvdDs7CgpvcHRpb24gZ29fcGFja2FnZSA9ICZxdW90O2dpdGh1Yi5jb20vZXhhbXBsZS9ibG9nL3gvYmxvZy90eXBlcyZxdW90OzsKCi8vIFF1ZXJ5IGRlZmluZXMgdGhlIGdSUEMgcXVlcmllciBzZXJ2aWNlLgpzZXJ2aWNlIFF1ZXJ5IHsKCS8vIHRoaXMgbGluZSBpcyB1c2VkIGJ5IHN0YXJwb3J0IHNjYWZmb2xkaW5nICMgMgoJcnBjIFBvc3QoUXVlcnlHZXRQb3N0UmVxdWVzdCkgcmV0dXJucyAoUXVlcnlHZXRQb3N0UmVzcG9uc2UpIHsKCQlvcHRpb24gKGdvb2dsZS5hcGkuaHR0cCkuZ2V0ID0gJnF1b3Q7L2V4YW1wbGUvYmxvZy9ibG9nL3Bvc3Qve2lkfSZxdW90OzsKCX0KCXJwYyBQb3N0QWxsKFF1ZXJ5QWxsUG9zdFJlcXVlc3QpIHJldHVybnMgKFF1ZXJ5QWxsUG9zdFJlc3BvbnNlKSB7CgkJb3B0aW9uIChnb29nbGUuYXBpLmh0dHApLmdldCA9ICZxdW90Oy9leGFtcGxlL2Jsb2cvYmxvZy9wb3N0JnF1b3Q7OwoJfQp9CgovLyB0aGlzIGxpbmUgaXMgdXNlZCBieSBzdGFycG9ydCBzY2FmZm9sZGluZyAjIDMKbWVzc2FnZSBRdWVyeUdldFBvc3RSZXF1ZXN0IHsKCXN0cmluZyBpZCA9IDE7Cn0KCm1lc3NhZ2UgUXVlcnlHZXRQb3N0UmVzcG9uc2UgewoJUG9zdCBQb3N0ID0gMTsKfQoKbWVzc2FnZSBRdWVyeUFsbFBvc3RSZXF1ZXN0IHsKCWNvc21vcy5iYXNlLnF1ZXJ5LnYxYmV0YTEuUGFnZVJlcXVlc3QgcGFnaW5hdGlvbiA9IDE7Cn0KCm1lc3NhZ2UgUXVlcnlBbGxQb3N0UmVzcG9uc2UgewoJcmVwZWF0ZWQgUG9zdCBQb3N0ID0gMTsKCWNvc21vcy5iYXNlLnF1ZXJ5LnYxYmV0YTEuUGFnZVJlc3BvbnNlIHBhZ2luYXRpb24gPSAyOwp9Cg=="}}),e._v(" "),t("p",[e._v("In our proto file we define the structure of the API endpoint, as well as our request and response structure of the post.")]),e._v(" "),t("h2",{attrs:{id:"edit-the-query-functions-in-the-cli"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#edit-the-query-functions-in-the-cli"}},[e._v("#")]),e._v(" Edit the Query Functions in the CLI")]),e._v(" "),t("p",[e._v("Function "),t("code",[e._v("GetQueryCmd")]),e._v(" is used for creating a list of "),t("code",[e._v("query")]),e._v(" subcommands, it should already be defined. Edit the function to add "),t("code",[e._v("CmdListPost")]),e._v(" and "),t("code",[e._v("CmdShowPost")]),e._v(" as a subcommand:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9ibG9nL2NsaWVudC9jbGkvcXVlcnkuZ28KCQoJLy8gdGhpcyBsaW5lIGlzIHVzZWQgYnkgc3RhcnBvcnQgc2NhZmZvbGRpbmcgIyAxCgljbWQuQWRkQ29tbWFuZChDbWRMaXN0UG9zdCgpKQoJY21kLkFkZENvbW1hbmQoQ21kU2hvd1Bvc3QoKSkK"}}),e._v(" "),t("p",[e._v("Now define "),t("code",[e._v("CmdListPost")]),e._v(" in a new "),t("code",[e._v("queryPost.go")]),e._v(" file:")]),e._v(" "),t("h2",{attrs:{id:"add-the-query-post-to-the-cli"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-the-query-post-to-the-cli"}},[e._v("#")]),e._v(" Add the Query Post to the CLI")]),e._v(" "),t("p",[e._v("Create the "),t("code",[e._v("x/blog/client/cli/queryPost.go")]),e._v(" file.")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9ibG9nL2NsaWVudC9jbGkvcXVlcnlQb3N0LmdvCnBhY2thZ2UgY2xpCgppbXBvcnQgKAoJJnF1b3Q7Y29udGV4dCZxdW90OwoKCSZxdW90O2dpdGh1Yi5jb20vc3BmMTMvY29icmEmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL2NsaWVudCZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay9jbGllbnQvZmxhZ3MmcXVvdDsKCSZxdW90O2dpdGh1Yi5jb20vZXhhbXBsZS9ibG9nL3gvYmxvZy90eXBlcyZxdW90OwopCgpmdW5jIENtZExpc3RQb3N0KCkgKmNvYnJhLkNvbW1hbmQgewoJY21kIDo9ICZhbXA7Y29icmEuQ29tbWFuZHsKCQlVc2U6ICAgJnF1b3Q7bGlzdC1wb3N0JnF1b3Q7LAoJCVNob3J0OiAmcXVvdDtsaXN0IGFsbCBwb3N0JnF1b3Q7LAoJCVJ1bkU6IGZ1bmMoY21kICpjb2JyYS5Db21tYW5kLCBhcmdzIFtdc3RyaW5nKSBlcnJvciB7CgkJCWNsaWVudEN0eCwgZXJyIDo9IGNsaWVudC5HZXRDbGllbnRUeENvbnRleHQoY21kKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoKCQkJcGFnZVJlcSwgZXJyIDo9IGNsaWVudC5SZWFkUGFnZVJlcXVlc3QoY21kLkZsYWdzKCkpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJcmV0dXJuIGVycgoJCQl9CgoJCQlxdWVyeUNsaWVudCA6PSB0eXBlcy5OZXdRdWVyeUNsaWVudChjbGllbnRDdHgpCgoJCQlwYXJhbXMgOj0gJmFtcDt0eXBlcy5RdWVyeUFsbFBvc3RSZXF1ZXN0ewoJCQkJUGFnaW5hdGlvbjogcGFnZVJlcSwKCQkJfQoKCQkJcmVzLCBlcnIgOj0gcXVlcnlDbGllbnQuUG9zdEFsbChjb250ZXh0LkJhY2tncm91bmQoKSwgcGFyYW1zKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoKCQkJcmV0dXJuIGNsaWVudEN0eC5QcmludFByb3RvKHJlcykKCQl9LAoJfQoKCWZsYWdzLkFkZFF1ZXJ5RmxhZ3NUb0NtZChjbWQpCgoJcmV0dXJuIGNtZAp9CgpmdW5jIENtZFNob3dQb3N0KCkgKmNvYnJhLkNvbW1hbmQgewoJY21kIDo9ICZhbXA7Y29icmEuQ29tbWFuZHsKCQlVc2U6ICAgJnF1b3Q7c2hvdy1wb3N0IFtpZF0mcXVvdDssCgkJU2hvcnQ6ICZxdW90O3Nob3dzIGEgcG9zdCZxdW90OywKCQlBcmdzOiAgY29icmEuRXhhY3RBcmdzKDEpLAoJCVJ1bkU6IGZ1bmMoY21kICpjb2JyYS5Db21tYW5kLCBhcmdzIFtdc3RyaW5nKSBlcnJvciB7CgkJCWNsaWVudEN0eCwgZXJyIDo9IGNsaWVudC5HZXRDbGllbnRUeENvbnRleHQoY21kKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoKCQkJcXVlcnlDbGllbnQgOj0gdHlwZXMuTmV3UXVlcnlDbGllbnQoY2xpZW50Q3R4KQoKCQkJcGFyYW1zIDo9ICZhbXA7dHlwZXMuUXVlcnlHZXRQb3N0UmVxdWVzdHsKCQkJCUlkOiBhcmdzWzBdLAoJCQl9CgoJCQlyZXMsIGVyciA6PSBxdWVyeUNsaWVudC5Qb3N0KGNvbnRleHQuQmFja2dyb3VuZCgpLCBwYXJhbXMpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJcmV0dXJuIGVycgoJCQl9CgoJCQlyZXR1cm4gY2xpZW50Q3R4LlByaW50UHJvdG8ocmVzKSAKCQl9LAoJfQoKCWZsYWdzLkFkZFF1ZXJ5RmxhZ3NUb0NtZChjbWQpCgoJcmV0dXJuIGNtZAp9Cg=="}}),e._v(" "),t("p",[t("code",[e._v("CmdListPost")]),e._v(" and "),t("code",[e._v("CmdShowPost")]),e._v(" run an "),t("a",{attrs:{href:"https://docs.tendermint.com/master/spec/abci/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ABCI"),t("OutboundLink")],1),e._v(" query to fetch the data, unmarshals it back form binary to JSON and returns it to the console. ABCI is an interface between your app and Tendermint (a program responsible for replicating the state across machines). ABCI queries look like paths on a hierarchical filesystem. In our case, the query is "),t("code",[e._v("custom/blog/list-post")]),e._v(". Before we continue, we need to define "),t("code",[e._v("QueryListPost")]),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"add-the-two-query-commands-to-the-types"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-the-two-query-commands-to-the-types"}},[e._v("#")]),e._v(" Add the Two Query Commands to the Types")]),e._v(" "),t("p",[e._v("Define a "),t("code",[e._v("QueryListPost")]),e._v(" that will be used later on to dispatch query requests:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9ibG9nL3R5cGVzL3F1ZXJ5LmdvCnBhY2thZ2UgdHlwZXMKCmNvbnN0ICgKCVF1ZXJ5R2V0UG9zdCAgPSAmcXVvdDtnZXQtcG9zdCZxdW90OwoJUXVlcnlMaXN0UG9zdCA9ICZxdW90O2xpc3QtcG9zdCZxdW90OwopCgo="}}),e._v(" "),t("h2",{attrs:{id:"add-the-query-functions-to-the-keeper"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-the-query-functions-to-the-keeper"}},[e._v("#")]),e._v(" Add the Query Functions to the Keeper")]),e._v(" "),t("p",[t("code",[e._v("NewQuerier")]),e._v(" acts as a dispatcher for query functions, it should already be defined. Modify the switch statement to include "),t("code",[e._v("listPost")]),e._v(":")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9ibG9nL2tlZXBlci9xdWVyeS5nbwoKCQlzd2l0Y2ggcGF0aFswXSB7CgkJLy8gdGhpcyBsaW5lIGlzIHVzZWQgYnkgc3RhcnBvcnQgc2NhZmZvbGRpbmcgIyAyCgkJY2FzZSB0eXBlcy5RdWVyeUdldFBvc3Q6CgkJCXJldHVybiBnZXRQb3N0KGN0eCwgcGF0aFsxXSwgaywgbGVnYWN5UXVlcmllckNkYykKCQljYXNlIHR5cGVzLlF1ZXJ5TGlzdFBvc3Q6CgkJCXJldHVybiBsaXN0UG9zdChjdHgsIGssIGxlZ2FjeVF1ZXJpZXJDZGMpCgkJZGVmYXVsdDoK"}}),e._v(" "),t("p",[e._v("Now define "),t("code",[e._v("listPost")]),e._v(":")]),e._v(" "),t("h3",{attrs:{id:"add-the-query-post-functions-to-the-keeper"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-the-query-post-functions-to-the-keeper"}},[e._v("#")]),e._v(" Add the Query Post Functions to the Keeper")]),e._v(" "),t("p",[e._v("Create a new file "),t("code",[e._v("query_post.go")]),e._v(" in the "),t("code",[e._v("keeper/")]),e._v(" directory")]),e._v(" "),t("p",[e._v("Make sure to add the codec to the previous import and add the "),t("code",[e._v("listPost")]),e._v(" and "),t("code",[e._v("getPost")]),e._v(" function in a new file called "),t("code",[e._v("query_post.go")]),e._v(" in our keeper.")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9ibG9nL2tlZXBlci9xdWVyeV9wb3N0LmdvCnBhY2thZ2Uga2VlcGVyCgppbXBvcnQgKAoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay9jb2RlYyZxdW90OwoJc2RrICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvdHlwZXMmcXVvdDsKCXNka2Vycm9ycyAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzL2Vycm9ycyZxdW90OwopCgpmdW5jIGxpc3RQb3N0KGN0eCBzZGsuQ29udGV4dCwga2VlcGVyIEtlZXBlciwgbGVnYWN5UXVlcmllckNkYyAqY29kZWMuTGVnYWN5QW1pbm8pIChbXWJ5dGUsIGVycm9yKSB7Cgltc2dzIDo9IGtlZXBlci5HZXRBbGxQb3N0KGN0eCkKCglieiwgZXJyIDo9IGNvZGVjLk1hcnNoYWxKU09OSW5kZW50KGxlZ2FjeVF1ZXJpZXJDZGMsIG1zZ3MpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBzZGtlcnJvcnMuV3JhcChzZGtlcnJvcnMuRXJySlNPTk1hcnNoYWwsIGVyci5FcnJvcigpKQoJfQoKCXJldHVybiBieiwgbmlsCn0KCmZ1bmMgZ2V0UG9zdChjdHggc2RrLkNvbnRleHQsIGlkIHN0cmluZywga2VlcGVyIEtlZXBlciwgbGVnYWN5UXVlcmllckNkYyAqY29kZWMuTGVnYWN5QW1pbm8pIChbXWJ5dGUsIGVycm9yKSB7Cgltc2cgOj0ga2VlcGVyLkdldFBvc3QoY3R4LCBpZCkKCglieiwgZXJyIDo9IGNvZGVjLk1hcnNoYWxKU09OSW5kZW50KGxlZ2FjeVF1ZXJpZXJDZGMsIG1zZykKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIHNka2Vycm9ycy5XcmFwKHNka2Vycm9ycy5FcnJKU09OTWFyc2hhbCwgZXJyLkVycm9yKCkpCgl9CgoJcmV0dXJuIGJ6LCBuaWwKfQo="}}),e._v(" "),t("p",[e._v("In the keeper we define also the grpc of our queryPost function.")]),e._v(" "),t("h3",{attrs:{id:"add-grpc-functionality"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-grpc-functionality"}},[e._v("#")]),e._v(" Add GRPC functionality")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9ibG9jay9rZWVwZXIvZ3JwY19xdWVyeV9wb3N0LmdvCnBhY2thZ2Uga2VlcGVyCgppbXBvcnQgKAoJJnF1b3Q7Y29udGV4dCZxdW90OwoKCSZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvc3RvcmUvcHJlZml4JnF1b3Q7CglzZGsgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcyZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9xdWVyeSZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9leGFtcGxlL2Jsb2cveC9ibG9nL3R5cGVzJnF1b3Q7CgkmcXVvdDtnb29nbGUuZ29sYW5nLm9yZy9ncnBjL2NvZGVzJnF1b3Q7CgkmcXVvdDtnb29nbGUuZ29sYW5nLm9yZy9ncnBjL3N0YXR1cyZxdW90OwopCgpmdW5jIChrIEtlZXBlcikgUG9zdEFsbChjIGNvbnRleHQuQ29udGV4dCwgcmVxICp0eXBlcy5RdWVyeUFsbFBvc3RSZXF1ZXN0KSAoKnR5cGVzLlF1ZXJ5QWxsUG9zdFJlc3BvbnNlLCBlcnJvcikgewoJaWYgcmVxID09IG5pbCB7CgkJcmV0dXJuIG5pbCwgc3RhdHVzLkVycm9yKGNvZGVzLkludmFsaWRBcmd1bWVudCwgJnF1b3Q7aW52YWxpZCByZXF1ZXN0JnF1b3Q7KQoJfQoKCXZhciBwb3N0cyBbXSp0eXBlcy5Qb3N0CgljdHggOj0gc2RrLlVud3JhcFNES0NvbnRleHQoYykKCglzdG9yZSA6PSBjdHguS1ZTdG9yZShrLnN0b3JlS2V5KQoJcG9zdFN0b3JlIDo9IHByZWZpeC5OZXdTdG9yZShzdG9yZSwgdHlwZXMuS2V5UHJlZml4KHR5cGVzLlBvc3RLZXkpKQoKCXBhZ2VSZXMsIGVyciA6PSBxdWVyeS5QYWdpbmF0ZShwb3N0U3RvcmUsIHJlcS5QYWdpbmF0aW9uLCBmdW5jKGtleSBbXWJ5dGUsIHZhbHVlIFtdYnl0ZSkgZXJyb3IgewoJCXZhciBwb3N0IHR5cGVzLlBvc3QKCQlpZiBlcnIgOj0gay5jZGMuVW5tYXJzaGFsQmluYXJ5QmFyZSh2YWx1ZSwgJmFtcDtwb3N0KTsgZXJyICE9IG5pbCB7CgkJCXJldHVybiBlcnIKCQl9CgoJCXBvc3RzID0gYXBwZW5kKHBvc3RzLCAmYW1wO3Bvc3QpCgkJcmV0dXJuIG5pbAoJfSkKCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBzdGF0dXMuRXJyb3IoY29kZXMuSW50ZXJuYWwsIGVyci5FcnJvcigpKQoJfQoKCXJldHVybiAmYW1wO3R5cGVzLlF1ZXJ5QWxsUG9zdFJlc3BvbnNle1Bvc3Q6IHBvc3RzLCBQYWdpbmF0aW9uOiBwYWdlUmVzfSwgbmlsCn0KCmZ1bmMgKGsgS2VlcGVyKSBQb3N0KGMgY29udGV4dC5Db250ZXh0LCByZXEgKnR5cGVzLlF1ZXJ5R2V0UG9zdFJlcXVlc3QpICgqdHlwZXMuUXVlcnlHZXRQb3N0UmVzcG9uc2UsIGVycm9yKSB7CglpZiByZXEgPT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBzdGF0dXMuRXJyb3IoY29kZXMuSW52YWxpZEFyZ3VtZW50LCAmcXVvdDtpbnZhbGlkIHJlcXVlc3QmcXVvdDspCgl9CgoJdmFyIHBvc3QgdHlwZXMuUG9zdAoJY3R4IDo9IHNkay5VbndyYXBTREtDb250ZXh0KGMpCgoJc3RvcmUgOj0gcHJlZml4Lk5ld1N0b3JlKGN0eC5LVlN0b3JlKGsuc3RvcmVLZXkpLCB0eXBlcy5LZXlQcmVmaXgodHlwZXMuUG9zdEtleSkpCglrLmNkYy5NdXN0VW5tYXJzaGFsQmluYXJ5QmFyZShzdG9yZS5HZXQodHlwZXMuS2V5UHJlZml4KHR5cGVzLlBvc3RLZXkgKyByZXEuSWQpKSwgJmFtcDtwb3N0KQoKCXJldHVybiAmYW1wO3R5cGVzLlF1ZXJ5R2V0UG9zdFJlc3BvbnNle1Bvc3Q6ICZhbXA7cG9zdH0sIG5pbAp9Cg=="}}),e._v(" "),t("p",[e._v("We add the grpc query handler to our module on")]),e._v(" "),t("h3",{attrs:{id:"add-grpc-to-the-module-handler"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-grpc-to-the-module-handler"}},[e._v("#")]),e._v(" Add GRPC to the Module Handler")]),e._v(" "),t("p",[e._v("Let's make sure to import "),t("code",[e._v("context")]),e._v(" and add the "),t("code",[e._v("RegisterGRPCGatewayRoutes")])]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9ibG9nL21vZHVsZS5nbwppbXBvcnQgKAoJJnF1b3Q7Y29udGV4dCZxdW90OwoJLy8gLi4uIG90aGVyIGltcG9ydHMKKQo="}}),e._v(" "),t("p",[e._v("Search for the "),t("code",[e._v("RegisterGRPCGatewayRoutes")]),e._v(" function and add the "),t("code",[e._v("RegisterQueryHandlerClient")])]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9ibG9nL21vZHVsZS5nbwpmdW5jIChBcHBNb2R1bGVCYXNpYykgUmVnaXN0ZXJHUlBDR2F0ZXdheVJvdXRlcyhjbGllbnRDdHggY2xpZW50LkNvbnRleHQsIG11eCAqcnVudGltZS5TZXJ2ZU11eCkgewoJLy8gdGhpcyBsaW5lIGlzIHVzZWQgYnkgc3RhcnBvcnQgc2NhZmZvbGRpbmcgIyAyCgl0eXBlcy5SZWdpc3RlclF1ZXJ5SGFuZGxlckNsaWVudChjb250ZXh0LkJhY2tncm91bmQoKSwgbXV4LCB0eXBlcy5OZXdRdWVyeUNsaWVudChjbGllbnRDdHgpKQp9Cg=="}}),e._v(" "),t("p",[e._v("This function uses a prefix iterator to loop through all the keys with a given prefix (in our case "),t("code",[e._v("PostKey")]),e._v(" is "),t("code",[e._v('"Post-value-"')]),e._v("). We’re getting values by key with "),t("code",[e._v("store.Get")]),e._v(" and appending them to "),t("code",[e._v("postList")]),e._v(". Finally, we unmarshal bytes back to JSON and return the result to the console.")]),e._v(" "),t("p",[e._v("Now let’s see how it works. Run the following command to recompile your app, clear the data and relaunch the chain:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"c3RhcnBvcnQgc2VydmUK"}}),e._v(" "),t("p",[e._v("After the app has launched, open a different terminal window and create a post:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"YmxvZ2QgdHggYmxvZyBjcmVhdGUtcG9zdCAnSGVsbG8hJyAnVGhpcyBpcyBteSBmaXJzdCBibG9nIHBvc3QuJyAtLWZyb209YWxpY2UK"}}),e._v(" "),t("p",[e._v("Now run the query to see the post:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"YmxvZ2QgcXVlcnkgYmxvZyBsaXN0LXBvc3QK"}}),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"UG9zdDoKLSBib2R5OiBUaGlzIGlzIG15IGZpcnN0IGJsb2cgcG9zdC4KICBjcmVhdG9yOiBjb3Ntb3MxbWM2bGV5amR3ZDl5Z3hlcWRudnRzaDdrczNrbnB0amYzczVsZjkKICBpZDogJnF1b3Q7MCZxdW90OwogIHRpdGxlOiBIZWxsbyEK"}}),e._v(" "),t("p",[e._v("That’s a newly created post along with your address and a unique ID. Try creating more posts and see the output.")]),e._v(" "),t("p",[e._v("You can also make "),t("a",{attrs:{href:"https://docs.tendermint.com/master/spec/abci/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ABCI"),t("OutboundLink")],1),e._v(" queries from the browser:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"aHR0cDovL2xvY2FsaG9zdDoyNjY1Ny9hYmNpX3F1ZXJ5P3BhdGg9JnF1b3Q7Y3VzdG9tL2Jsb2cvbGlzdC1wb3N0JnF1b3Q7Cg=="}}),e._v(" "),t("p",[e._v("The result of this query is a base64 encoded string inside "),t("code",[e._v("result.response.value")]),e._v(". You can decode it using a browser’s built in JavaScript console: "),t("code",[e._v('atob("WwogIHsKICAgICJjcmV...")')]),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"errors"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#errors"}},[e._v("#")]),e._v(" Errors")]),e._v(" "),t("h3",{attrs:{id:"null"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#null"}},[e._v("#")]),e._v(" "),t("code",[e._v("null")])]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"YmxvZ2QgcSBibG9nIGxpc3QtcG9zdApudWxsCg=="}}),e._v(" "),t("p",[e._v("This is actually not an error, but may be a bit confusing. If you've added a post and immediately issued "),t("code",[e._v("list-post")]),e._v(" subcommand, you may get a "),t("code",[e._v("null")]),e._v(". This happens, because it takes several seconds to process the block. After a couple of seconds you should be able to see output of "),t("code",[e._v("list-post")]),e._v(" subcommand.")])],1)}),[],!1,null,null,null);c.default=o.exports}}]);