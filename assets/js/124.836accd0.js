(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{618:function(l,d,c){"use strict";c.r(d);var Z=c(0),a=Object(Z.a)({},(function(){var l=this,d=l.$createElement,c=l._self._c||d;return c("ContentSlotsDistributor",{attrs:{"slot-key":l.$parent.slotKey}},[c("h1",{attrs:{id:"handler"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handler"}},[l._v("#")]),l._v(" Handler")]),l._v(" "),c("p",[l._v("In order for a "),c("strong",[l._v("Message")]),l._v(" to reach a "),c("strong",[l._v("Keeper")]),l._v(", it has to go through a "),c("strong",[l._v("Handler")]),l._v(". This is where logic can be applied to either allow or deny a "),c("code",[l._v("Message")]),l._v(" to succeed. It's also where logic exactly shows how the state change should take place within the Keeper. If you're familiar with "),c("a",{attrs:{href:"https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller",target:"_blank",rel:"noopener noreferrer"}},[l._v("Model View Controller"),c("OutboundLink")],1),l._v(" (MVC) architecture, the "),c("code",[l._v("Keeper")]),l._v(" is a bit like the "),c("strong",[l._v("Model")]),l._v(" and the "),c("code",[l._v("Handler")]),l._v(" is a bit like the "),c("strong",[l._v("Controller")]),l._v(". If you're familiar with "),c("a",{attrs:{href:"https://en.wikipedia.org/wiki/React_(web_framework)",target:"_blank",rel:"noopener noreferrer"}},[l._v("React/Redux"),c("OutboundLink")],1),l._v(" or "),c("a",{attrs:{href:"https://en.wikipedia.org/wiki/Vue.js",target:"_blank",rel:"noopener noreferrer"}},[l._v("Vue/Vuex"),c("OutboundLink")],1),l._v(" architecture, the "),c("code",[l._v("Keeper")]),l._v(" is a bit like the "),c("strong",[l._v("Reducer/Store")]),l._v(" and the "),c("code",[l._v("Handler")]),l._v(" is a bit like "),c("strong",[l._v("Actions")]),l._v(".")]),l._v(" "),c("p",[l._v("Our Handler will go in "),c("code",[l._v("./x/scavenge/handler.go")]),l._v(" and will follow the suggestions outlined in the boilerplate. We will create handler functions in separate files named "),c("code",[l._v("handler<Action.go")]),l._v(" for each of our three "),c("code",[l._v("Message")]),l._v(" types, "),c("code",[l._v("MsgCreateScavenge")]),l._v(", "),c("code",[l._v("MsgCommitSolution")]),l._v(" and "),c("code",[l._v("MsgRevealSolution")]),l._v(".")]),l._v(" "),c("p",[l._v("Running the "),c("code",[l._v("starport type")]),l._v(" command should have already added a "),c("code",[l._v("handlerMsgCreateScavenge.go")]),l._v(" and a "),c("code",[l._v("handlerMsgCreateCommit.go")]),l._v(" file. In essence, you can rename "),c("code",[l._v("handlerMsgCreateCommit")]),l._v(" to "),c("code",[l._v("handlerMsgCommitSolution")]),l._v(". Make a copy and use it as the template for "),c("code",[l._v("handlerMsgRevealSolution")]),l._v(". We'll be modifying the files to look as follows:")]),l._v(" "),c("h4",{attrs:{id:"handlermsgcreatescavenge-go"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handlermsgcreatescavenge-go"}},[l._v("#")]),l._v(" "),c("code",[l._v("handlerMsgCreateScavenge.go")])]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBzY2F2ZW5nZQoKaW1wb3J0ICgKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCSZxdW90O2dpdGh1Yi5jb20vdGVuZGVybWludC90ZW5kZXJtaW50L2NyeXB0byZxdW90OwoKCSZxdW90O2dpdGh1Yi5jb20vZ2l0aHViLXVzZXJuYW1lL3NjYXZlbmdlL3gvc2NhdmVuZ2Uva2VlcGVyJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL3R5cGVzJnF1b3Q7CikKCmZ1bmMgaGFuZGxlTXNnQ3JlYXRlU2NhdmVuZ2UoY3R4IHNkay5Db250ZXh0LCBrIGtlZXBlci5LZWVwZXIsIG1zZyB0eXBlcy5Nc2dDcmVhdGVTY2F2ZW5nZSkgKCpzZGsuUmVzdWx0LCBlcnJvcikgewoJdmFyIHNjYXZlbmdlID0gdHlwZXMuU2NhdmVuZ2V7CgkJQ3JlYXRvcjogICAgICBtc2cuQ3JlYXRvciwKCQlEZXNjcmlwdGlvbjogIG1zZy5EZXNjcmlwdGlvbiwKCQlTb2x1dGlvbkhhc2g6IG1zZy5Tb2x1dGlvbkhhc2gsCgkJUmV3YXJkOiAgICAgICBtc2cuUmV3YXJkLAoJfQoKCS8vIEVuc3VyZSBubyBzY2F2ZW5nZSBleGlzdHMKCV8sIGVyciA6PSBrLkdldFNjYXZlbmdlKGN0eCwgc2NhdmVuZ2UuU29sdXRpb25IYXNoKQoJaWYgZXJyID09IG5pbCB7CgkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXAoc2RrZXJyb3JzLkVyckludmFsaWRSZXF1ZXN0LCAmcXVvdDtTY2F2ZW5nZSB3aXRoIHRoYXQgc29sdXRpb24gaGFzaCBhbHJlYWR5IGV4aXN0cyZxdW90OykKCX0KCW1vZHVsZUFjY3QgOj0gc2RrLkFjY0FkZHJlc3MoY3J5cHRvLkFkZHJlc3NIYXNoKFtdYnl0ZSh0eXBlcy5Nb2R1bGVOYW1lKSkpCglzZGtFcnJvciA6PSBrLkNvaW5LZWVwZXIuU2VuZENvaW5zKGN0eCwgc2NhdmVuZ2UuQ3JlYXRvciwgbW9kdWxlQWNjdCwgc2NhdmVuZ2UuUmV3YXJkKQoJaWYgc2RrRXJyb3IgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBzZGtFcnJvcgoJfQoKCWsuQ3JlYXRlU2NhdmVuZ2UoY3R4LCBzY2F2ZW5nZSkKCWN0eC5FdmVudE1hbmFnZXIoKS5FbWl0RXZlbnQoCgkJc2RrLk5ld0V2ZW50KAoJCQlzZGsuRXZlbnRUeXBlTWVzc2FnZSwKCQkJc2RrLk5ld0F0dHJpYnV0ZShzZGsuQXR0cmlidXRlS2V5TW9kdWxlLCB0eXBlcy5BdHRyaWJ1dGVWYWx1ZUNhdGVnb3J5KSwKCQkJc2RrLk5ld0F0dHJpYnV0ZShzZGsuQXR0cmlidXRlS2V5QWN0aW9uLCB0eXBlcy5FdmVudFR5cGVDcmVhdGVTY2F2ZW5nZSksCgkJCXNkay5OZXdBdHRyaWJ1dGUoc2RrLkF0dHJpYnV0ZUtleVNlbmRlciwgbXNnLkNyZWF0b3IuU3RyaW5nKCkpLAoJCQlzZGsuTmV3QXR0cmlidXRlKHR5cGVzLkF0dHJpYnV0ZURlc2NyaXB0aW9uLCBtc2cuRGVzY3JpcHRpb24pLAoJCQlzZGsuTmV3QXR0cmlidXRlKHR5cGVzLkF0dHJpYnV0ZVNvbHV0aW9uSGFzaCwgbXNnLlNvbHV0aW9uSGFzaCksCgkJCXNkay5OZXdBdHRyaWJ1dGUodHlwZXMuQXR0cmlidXRlUmV3YXJkLCBtc2cuUmV3YXJkLlN0cmluZygpKSwKCQkpLAoJKQoJcmV0dXJuICZhbXA7c2RrLlJlc3VsdHtFdmVudHM6IGN0eC5FdmVudE1hbmFnZXIoKS5FdmVudHMoKX0sIG5pbAp9Cg=="}}),l._v(" "),c("h4",{attrs:{id:"handlermsgsetscavenge-go"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handlermsgsetscavenge-go"}},[l._v("#")]),l._v(" "),c("code",[l._v("handlerMsgSetScavenge.go")])]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBzY2F2ZW5nZQoKaW1wb3J0ICgKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL2tlZXBlciZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9naXRodWItdXNlcm5hbWUvc2NhdmVuZ2UveC9zY2F2ZW5nZS90eXBlcyZxdW90OwopCgpmdW5jIGhhbmRsZU1zZ1NldFNjYXZlbmdlKGN0eCBzZGsuQ29udGV4dCwgayBrZWVwZXIuS2VlcGVyLCBtc2cgdHlwZXMuTXNnU2V0U2NhdmVuZ2UpICgqc2RrLlJlc3VsdCwgZXJyb3IpIHsKCXZhciBzY2F2ZW5nZSA9IHR5cGVzLlNjYXZlbmdlewoJCUNyZWF0b3I6ICAgICAgbXNnLkNyZWF0b3IsCgkJRGVzY3JpcHRpb246ICBtc2cuRGVzY3JpcHRpb24sCgkJU29sdXRpb25IYXNoOiBtc2cuU29sdXRpb25IYXNoLAoJCVNvbHV0aW9uOiAgICAgbXNnLlNvbHV0aW9uLAoJfQoJaWYgIW1zZy5DcmVhdG9yLkVxdWFscyhrLkdldFNjYXZlbmdlT3duZXIoY3R4LCBtc2cuU29sdXRpb25IYXNoKSkgeyAvLyBDaGVja3MgaWYgdGhlIHRoZSBtc2cgc2VuZGVyIGlzIHRoZSBzYW1lIGFzIHRoZSBjdXJyZW50IG93bmVyCgkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXAoc2RrZXJyb3JzLkVyclVuYXV0aG9yaXplZCwgJnF1b3Q7SW5jb3JyZWN0IE93bmVyJnF1b3Q7KSAvLyBJZiBub3QsIHRocm93IGFuIGVycm9yCgl9CgoJay5TZXRTY2F2ZW5nZShjdHgsIHNjYXZlbmdlKQoKCXJldHVybiAmYW1wO3Nkay5SZXN1bHR7RXZlbnRzOiBjdHguRXZlbnRNYW5hZ2VyKCkuRXZlbnRzKCl9LCBuaWwKfQo="}}),l._v(" "),c("h4",{attrs:{id:"handlermsgdeletescavenge-go"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handlermsgdeletescavenge-go"}},[l._v("#")]),l._v(" "),c("code",[l._v("handlerMsgDeleteScavenge.go")])]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBzY2F2ZW5nZQoKaW1wb3J0ICgKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL3R5cGVzJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL2tlZXBlciZxdW90OwopCgovLyBIYW5kbGUgYSBtZXNzYWdlIHRvIGRlbGV0ZSBuYW1lCmZ1bmMgaGFuZGxlTXNnRGVsZXRlU2NhdmVuZ2UoY3R4IHNkay5Db250ZXh0LCBrIGtlZXBlci5LZWVwZXIsIG1zZyB0eXBlcy5Nc2dEZWxldGVTY2F2ZW5nZSkgKCpzZGsuUmVzdWx0LCBlcnJvcikgewoJaWYgIWsuU2NhdmVuZ2VFeGlzdHMoY3R4LCBtc2cuSUQpIHsKCQkvLyByZXBsYWNlIHdpdGggRXJyS2V5Tm90Rm91bmQgZm9yIDAuMzkrCgkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXAoc2RrZXJyb3JzLkVyckludmFsaWRSZXF1ZXN0LCBtc2cuSUQpCgl9CglpZiAhbXNnLkNyZWF0b3IuRXF1YWxzKGsuR2V0U2NhdmVuZ2VPd25lcihjdHgsIG1zZy5JRCkpIHsKCQlyZXR1cm4gbmlsLCBzZGtlcnJvcnMuV3JhcChzZGtlcnJvcnMuRXJyVW5hdXRob3JpemVkLCAmcXVvdDtJbmNvcnJlY3QgT3duZXImcXVvdDspCgl9CgoJay5EZWxldGVTY2F2ZW5nZShjdHgsIG1zZy5JRCkKCXJldHVybiAmYW1wO3Nkay5SZXN1bHR7fSwgbmlsCn0K"}}),l._v(" "),c("h4",{attrs:{id:"handlermsgcommitsolution-go"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handlermsgcommitsolution-go"}},[l._v("#")]),l._v(" "),c("code",[l._v("handlerMsgCommitSolution.go")])]),l._v(" "),c("p",[l._v("We rename our "),c("code",[l._v("handlerMsgCreateCommit.go")]),l._v(" to "),c("code",[l._v("handlerMsgCommitSolution.go")])]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBzY2F2ZW5nZQoKaW1wb3J0ICgKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL2tlZXBlciZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9naXRodWItdXNlcm5hbWUvc2NhdmVuZ2UveC9zY2F2ZW5nZS90eXBlcyZxdW90OwopCgpmdW5jIGhhbmRsZU1zZ0NvbW1pdFNvbHV0aW9uKGN0eCBzZGsuQ29udGV4dCwgayBrZWVwZXIuS2VlcGVyLCBtc2cgdHlwZXMuTXNnQ29tbWl0U29sdXRpb24pICgqc2RrLlJlc3VsdCwgZXJyb3IpIHsKCXZhciBjb21taXQgPSB0eXBlcy5Db21taXR7CgkJU2NhdmVuZ2VyOiAgICAgICAgICAgICBtc2cuU2NhdmVuZ2VyLAoJCVNvbHV0aW9uSGFzaDogICAgICAgICAgbXNnLlNvbHV0aW9uSGFzaCwKCQlTb2x1dGlvblNjYXZlbmdlckhhc2g6IG1zZy5Tb2x1dGlvblNjYXZlbmdlckhhc2gsCgl9CglfLCBlcnIgOj0gay5HZXRDb21taXQoY3R4LCBjb21taXQuU29sdXRpb25TY2F2ZW5nZXJIYXNoKQoJLy8gc2hvdWxkIHByb2R1Y2UgYW4gZXJyb3Igd2hlbiBjb21taXQgaXMgbm90IGZvdW5kCglpZiBlcnIgPT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBzZGtlcnJvcnMuV3JhcChzZGtlcnJvcnMuRXJySW52YWxpZFJlcXVlc3QsICZxdW90O0NvbW1pdCB3aXRoIHRoYXQgaGFzaCBhbHJlYWR5IGV4aXN0cyZxdW90OykKCX0KCWsuQ3JlYXRlQ29tbWl0KGN0eCwgY29tbWl0KQoJY3R4LkV2ZW50TWFuYWdlcigpLkVtaXRFdmVudCgKCQlzZGsuTmV3RXZlbnQoCgkJCXNkay5FdmVudFR5cGVNZXNzYWdlLAoJCQlzZGsuTmV3QXR0cmlidXRlKHNkay5BdHRyaWJ1dGVLZXlNb2R1bGUsIHR5cGVzLkF0dHJpYnV0ZVZhbHVlQ2F0ZWdvcnkpLAoJCQlzZGsuTmV3QXR0cmlidXRlKHNkay5BdHRyaWJ1dGVLZXlBY3Rpb24sIHR5cGVzLkV2ZW50VHlwZUNvbW1pdFNvbHV0aW9uKSwKCQkJc2RrLk5ld0F0dHJpYnV0ZShzZGsuQXR0cmlidXRlS2V5U2VuZGVyLCBtc2cuU2NhdmVuZ2VyLlN0cmluZygpKSwKCQkJc2RrLk5ld0F0dHJpYnV0ZSh0eXBlcy5BdHRyaWJ1dGVTb2x1dGlvbkhhc2gsIG1zZy5Tb2x1dGlvbkhhc2gpLAoJCQlzZGsuTmV3QXR0cmlidXRlKHR5cGVzLkF0dHJpYnV0ZVNvbHV0aW9uU2NhdmVuZ2VySGFzaCwgbXNnLlNvbHV0aW9uU2NhdmVuZ2VySGFzaCksCgkJKSwKCSkKCXJldHVybiAmYW1wO3Nkay5SZXN1bHR7RXZlbnRzOiBjdHguRXZlbnRNYW5hZ2VyKCkuRXZlbnRzKCl9LCBuaWwKfQo="}}),l._v(" "),c("h4",{attrs:{id:"handlermsgsetcommit-go"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handlermsgsetcommit-go"}},[l._v("#")]),l._v(" "),c("code",[l._v("handlerMsgSetCommit.go")])]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBzY2F2ZW5nZQoKaW1wb3J0ICgKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL2tlZXBlciZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9naXRodWItdXNlcm5hbWUvc2NhdmVuZ2UveC9zY2F2ZW5nZS90eXBlcyZxdW90OwopCgpmdW5jIGhhbmRsZU1zZ1NldENvbW1pdChjdHggc2RrLkNvbnRleHQsIGsga2VlcGVyLktlZXBlciwgbXNnIHR5cGVzLk1zZ1NldENvbW1pdCkgKCpzZGsuUmVzdWx0LCBlcnJvcikgewoJdmFyIGNvbW1pdCA9IHR5cGVzLkNvbW1pdHsKCQlTY2F2ZW5nZXI6ICAgICAgICAgICAgIG1zZy5TY2F2ZW5nZXIsCgkJU29sdXRpb25IYXNoOiAgICAgICAgICBtc2cuU29sdXRpb25IYXNoLAoJCVNvbHV0aW9uU2NhdmVuZ2VySGFzaDogbXNnLlNvbHV0aW9uU2NhdmVuZ2VySGFzaCwKCX0KCWlmICFtc2cuU2NhdmVuZ2VyLkVxdWFscyhrLkdldENvbW1pdE93bmVyKGN0eCwgbXNnLlNvbHV0aW9uSGFzaCkpIHsgLy8gQ2hlY2tzIGlmIHRoZSB0aGUgbXNnIHNlbmRlciBpcyB0aGUgc2FtZSBhcyB0aGUgY3VycmVudCBvd25lcgoJCXJldHVybiBuaWwsIHNka2Vycm9ycy5XcmFwKHNka2Vycm9ycy5FcnJVbmF1dGhvcml6ZWQsICZxdW90O0luY29ycmVjdCBPd25lciZxdW90OykgLy8gSWYgbm90LCB0aHJvdyBhbiBlcnJvcgoJfQoKCWsuU2V0Q29tbWl0KGN0eCwgY29tbWl0KQoKCXJldHVybiAmYW1wO3Nkay5SZXN1bHR7RXZlbnRzOiBjdHguRXZlbnRNYW5hZ2VyKCkuRXZlbnRzKCl9LCBuaWwKfQo="}}),l._v(" "),c("h4",{attrs:{id:"handlermsgdeletecommit-go"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handlermsgdeletecommit-go"}},[l._v("#")]),l._v(" "),c("code",[l._v("handlerMsgDeleteCommit.go")])]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBzY2F2ZW5nZQoKaW1wb3J0ICgKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL3R5cGVzJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL2tlZXBlciZxdW90OwopCgovLyBIYW5kbGUgYSBtZXNzYWdlIHRvIGRlbGV0ZSBuYW1lCmZ1bmMgaGFuZGxlTXNnRGVsZXRlQ29tbWl0KGN0eCBzZGsuQ29udGV4dCwgayBrZWVwZXIuS2VlcGVyLCBtc2cgdHlwZXMuTXNnRGVsZXRlQ29tbWl0KSAoKnNkay5SZXN1bHQsIGVycm9yKSB7CglpZiAhay5Db21taXRFeGlzdHMoY3R4LCBtc2cuSUQpIHsKCQkvLyByZXBsYWNlIHdpdGggRXJyS2V5Tm90Rm91bmQgZm9yIDAuMzkrCgkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXAoc2RrZXJyb3JzLkVyckludmFsaWRSZXF1ZXN0LCBtc2cuSUQpCgl9CglpZiAhbXNnLkNyZWF0b3IuRXF1YWxzKGsuR2V0Q29tbWl0T3duZXIoY3R4LCBtc2cuSUQpKSB7CgkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXAoc2RrZXJyb3JzLkVyclVuYXV0aG9yaXplZCwgJnF1b3Q7SW5jb3JyZWN0IE93bmVyJnF1b3Q7KQoJfQoKCWsuRGVsZXRlQ29tbWl0KGN0eCwgbXNnLklEKQoJcmV0dXJuICZhbXA7c2RrLlJlc3VsdHt9LCBuaWwKfQo="}}),l._v(" "),c("h4",{attrs:{id:"handlermsgrevealsolution-go"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handlermsgrevealsolution-go"}},[l._v("#")]),l._v(" "),c("code",[l._v("handlerMsgRevealSolution.go")])]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBzY2F2ZW5nZQoKaW1wb3J0ICgKCSZxdW90O2NyeXB0by9zaGEyNTYmcXVvdDsKCSZxdW90O2VuY29kaW5nL2hleCZxdW90OwoKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCSZxdW90O2dpdGh1Yi5jb20vdGVuZGVybWludC90ZW5kZXJtaW50L2NyeXB0byZxdW90OwoKCSZxdW90O2dpdGh1Yi5jb20vZ2l0aHViLXVzZXJuYW1lL3NjYXZlbmdlL3gvc2NhdmVuZ2Uva2VlcGVyJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL3R5cGVzJnF1b3Q7CikKCmZ1bmMgaGFuZGxlTXNnUmV2ZWFsU29sdXRpb24oY3R4IHNkay5Db250ZXh0LCBrIGtlZXBlci5LZWVwZXIsIG1zZyB0eXBlcy5Nc2dSZXZlYWxTb2x1dGlvbikgKCpzZGsuUmVzdWx0LCBlcnJvcikgewoJdmFyIHNvbHV0aW9uU2NhdmVuZ2VyQnl0ZXMgPSBbXWJ5dGUobXNnLlNvbHV0aW9uICsgbXNnLlNjYXZlbmdlci5TdHJpbmcoKSkKCXZhciBzb2x1dGlvblNjYXZlbmdlckhhc2ggPSBzaGEyNTYuU3VtMjU2KHNvbHV0aW9uU2NhdmVuZ2VyQnl0ZXMpCgl2YXIgc29sdXRpb25TY2F2ZW5nZXJIYXNoU3RyaW5nID0gaGV4LkVuY29kZVRvU3RyaW5nKHNvbHV0aW9uU2NhdmVuZ2VySGFzaFs6XSkKCV8sIGVyciA6PSBrLkdldENvbW1pdChjdHgsIHNvbHV0aW9uU2NhdmVuZ2VySGFzaFN0cmluZykKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIHNka2Vycm9ycy5XcmFwKGVyciwgJnF1b3Q7Q29tbWl0IHdpdGggdGhhdCBoYXNoIGRvZXNuJ3QgZXhpc3RzJnF1b3Q7KQoJfQoKCXZhciBzb2x1dGlvbkhhc2ggPSBzaGEyNTYuU3VtMjU2KFtdYnl0ZShtc2cuU29sdXRpb24pKQoJdmFyIHNvbHV0aW9uSGFzaFN0cmluZyA9IGhleC5FbmNvZGVUb1N0cmluZyhzb2x1dGlvbkhhc2hbOl0pCgl2YXIgc2NhdmVuZ2UgdHlwZXMuU2NhdmVuZ2UKCXNjYXZlbmdlLCBlcnIgPSBrLkdldFNjYXZlbmdlKGN0eCwgc29sdXRpb25IYXNoU3RyaW5nKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXAoZXJyLCAmcXVvdDtTY2F2ZW5nZSB3aXRoIHRoYXQgc29sdXRpb24gaGFzaCBkb2Vzbid0IGV4aXN0cyZxdW90OykKCX0KCWlmIHNjYXZlbmdlLlNjYXZlbmdlciAhPSBuaWwgewoJCXJldHVybiBuaWwsIHNka2Vycm9ycy5XcmFwKHNka2Vycm9ycy5FcnJJbnZhbGlkUmVxdWVzdCwgJnF1b3Q7U2NhdmVuZ2UgaGFzIGFscmVhZHkgYmVlbiBzb2x2ZWQmcXVvdDspCgl9CglzY2F2ZW5nZS5TY2F2ZW5nZXIgPSBtc2cuU2NhdmVuZ2VyCglzY2F2ZW5nZS5Tb2x1dGlvbiA9IG1zZy5Tb2x1dGlvbgoKCW1vZHVsZUFjY3QgOj0gc2RrLkFjY0FkZHJlc3MoY3J5cHRvLkFkZHJlc3NIYXNoKFtdYnl0ZSh0eXBlcy5Nb2R1bGVOYW1lKSkpCglzZGtFcnJvciA6PSBrLkNvaW5LZWVwZXIuU2VuZENvaW5zKGN0eCwgbW9kdWxlQWNjdCwgc2NhdmVuZ2UuU2NhdmVuZ2VyLCBzY2F2ZW5nZS5SZXdhcmQpCglpZiBzZGtFcnJvciAhPSBuaWwgewoJCXJldHVybiBuaWwsIHNka0Vycm9yCgl9CglrLlNldFNjYXZlbmdlKGN0eCwgc2NhdmVuZ2UpCgljdHguRXZlbnRNYW5hZ2VyKCkuRW1pdEV2ZW50KAoJCXNkay5OZXdFdmVudCgKCQkJc2RrLkV2ZW50VHlwZU1lc3NhZ2UsCgkJCXNkay5OZXdBdHRyaWJ1dGUoc2RrLkF0dHJpYnV0ZUtleU1vZHVsZSwgdHlwZXMuQXR0cmlidXRlVmFsdWVDYXRlZ29yeSksCgkJCXNkay5OZXdBdHRyaWJ1dGUoc2RrLkF0dHJpYnV0ZUtleUFjdGlvbiwgdHlwZXMuRXZlbnRUeXBlU29sdmVTY2F2ZW5nZSksCgkJCXNkay5OZXdBdHRyaWJ1dGUoc2RrLkF0dHJpYnV0ZUtleVNlbmRlciwgbXNnLlNjYXZlbmdlci5TdHJpbmcoKSksCgkJCXNkay5OZXdBdHRyaWJ1dGUodHlwZXMuQXR0cmlidXRlU29sdXRpb25IYXNoLCBzb2x1dGlvbkhhc2hTdHJpbmcpLAoJCQlzZGsuTmV3QXR0cmlidXRlKHR5cGVzLkF0dHJpYnV0ZURlc2NyaXB0aW9uLCBzY2F2ZW5nZS5EZXNjcmlwdGlvbiksCgkJCXNkay5OZXdBdHRyaWJ1dGUodHlwZXMuQXR0cmlidXRlU29sdXRpb24sIG1zZy5Tb2x1dGlvbiksCgkJCXNkay5OZXdBdHRyaWJ1dGUodHlwZXMuQXR0cmlidXRlU2NhdmVuZ2VyLCBzY2F2ZW5nZS5TY2F2ZW5nZXIuU3RyaW5nKCkpLAoJCQlzZGsuTmV3QXR0cmlidXRlKHR5cGVzLkF0dHJpYnV0ZVJld2FyZCwgc2NhdmVuZ2UuUmV3YXJkLlN0cmluZygpKSwKCQkpLAoJKQoJcmV0dXJuICZhbXA7c2RrLlJlc3VsdHtFdmVudHM6IGN0eC5FdmVudE1hbmFnZXIoKS5FdmVudHMoKX0sIG5pbAp9Cg=="}}),l._v(" "),c("p",[l._v("After we're done, we need to register these functions inside our main handler:")]),l._v(" "),c("h4",{attrs:{id:"handler-go"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#handler-go"}},[l._v("#")]),l._v(" "),c("code",[l._v("handler.go")])]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBzY2F2ZW5nZQoKaW1wb3J0ICgKCSZxdW90O2ZtdCZxdW90OwoKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CglzZGtlcnJvcnMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay90eXBlcy9lcnJvcnMmcXVvdDsKCSZxdW90O2dpdGh1Yi5jb20vZ2l0aHViLXVzZXJuYW1lL3NjYXZlbmdlL3gvc2NhdmVuZ2Uva2VlcGVyJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2dpdGh1Yi11c2VybmFtZS9zY2F2ZW5nZS94L3NjYXZlbmdlL3R5cGVzJnF1b3Q7CikKCi8vIE5ld0hhbmRsZXIgLi4uCmZ1bmMgTmV3SGFuZGxlcihrIGtlZXBlci5LZWVwZXIpIHNkay5IYW5kbGVyIHsKCXJldHVybiBmdW5jKGN0eCBzZGsuQ29udGV4dCwgbXNnIHNkay5Nc2cpICgqc2RrLlJlc3VsdCwgZXJyb3IpIHsKCQljdHggPSBjdHguV2l0aEV2ZW50TWFuYWdlcihzZGsuTmV3RXZlbnRNYW5hZ2VyKCkpCgkJc3dpdGNoIG1zZyA6PSBtc2cuKHR5cGUpIHsKCQkvLyB0aGlzIGxpbmUgaXMgdXNlZCBieSBzdGFycG9ydCBzY2FmZm9sZGluZyAjIDEKCQljYXNlIHR5cGVzLk1zZ1NldENvbW1pdDoKCQkJcmV0dXJuIGhhbmRsZU1zZ1NldENvbW1pdChjdHgsIGssIG1zZykKCQljYXNlIHR5cGVzLk1zZ0RlbGV0ZUNvbW1pdDoKCQkJcmV0dXJuIGhhbmRsZU1zZ0RlbGV0ZUNvbW1pdChjdHgsIGssIG1zZykKCQljYXNlIHR5cGVzLk1zZ0NvbW1pdFNvbHV0aW9uOgoJCQlyZXR1cm4gaGFuZGxlTXNnQ29tbWl0U29sdXRpb24oY3R4LCBrLCBtc2cpCgkJY2FzZSB0eXBlcy5Nc2dDcmVhdGVTY2F2ZW5nZToKCQkJcmV0dXJuIGhhbmRsZU1zZ0NyZWF0ZVNjYXZlbmdlKGN0eCwgaywgbXNnKQoJCWNhc2UgdHlwZXMuTXNnUmV2ZWFsU29sdXRpb246CgkJCXJldHVybiBoYW5kbGVNc2dSZXZlYWxTb2x1dGlvbihjdHgsIGssIG1zZykKCQljYXNlIHR5cGVzLk1zZ1NldFNjYXZlbmdlOgoJCQlyZXR1cm4gaGFuZGxlTXNnU2V0U2NhdmVuZ2UoY3R4LCBrLCBtc2cpCgkJY2FzZSB0eXBlcy5Nc2dEZWxldGVTY2F2ZW5nZToKCQkJcmV0dXJuIGhhbmRsZU1zZ0RlbGV0ZVNjYXZlbmdlKGN0eCwgaywgbXNnKQoJCWRlZmF1bHQ6CgkJCWVyck1zZyA6PSBmbXQuU3ByaW50ZigmcXVvdDt1bnJlY29nbml6ZWQgJXMgbWVzc2FnZSB0eXBlOiAlVCZxdW90OywgdHlwZXMuTW9kdWxlTmFtZSwgbXNnKQoJCQlyZXR1cm4gbmlsLCBzZGtlcnJvcnMuV3JhcChzZGtlcnJvcnMuRXJyVW5rbm93blJlcXVlc3QsIGVyck1zZykKCQl9Cgl9Cn0K"}}),l._v(" "),c("h2",{attrs:{id:"moduleacct"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#moduleacct"}},[l._v("#")]),l._v(" moduleAcct")]),l._v(" "),c("p",[l._v("You might notice the use of "),c("code",[l._v("moduleAcct")]),l._v(" within the "),c("code",[l._v("handlerMsgCreateScavenge")]),l._v(" and "),c("code",[l._v("handlerMsgRevealSolution")]),l._v(" handler functions. This account is not controlled by a public key pair, but is a reference to an account that is owned by this actual module. It is used to hold the bounty reward that is attached to a scavenge until that scavenge has been solved, at which point the bounty is paid to the account who solved the scavenge.")]),l._v(" "),c("h2",{attrs:{id:"events"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[l._v("#")]),l._v(" Events")]),l._v(" "),c("p",[l._v("At the end of each handler is an "),c("code",[l._v("EventManager")]),l._v(" which will create logs within the transaction that reveals information about what occurred during the handling of this message. This is useful for client side software that wants to know exactly what happened as a result of this state transition. These Events use a series of pre-defined types that can be found in "),c("code",[l._v("./x/scavenge/types/events.go")]),l._v(" and look as follows:")]),l._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSB0eXBlcwoKLy8gc2NhdmVuZ2UgbW9kdWxlIGV2ZW50IHR5cGVzCmNvbnN0ICgKCS8vIFRPRE86IENyZWF0ZSB5b3VyIGV2ZW50IHR5cGVzCgkvLyBFdmVudFR5cGUmbHQ7QWN0aW9uJmd0OyAgICAJCT0gJnF1b3Q7YWN0aW9uJnF1b3Q7CglFdmVudFR5cGVDcmVhdGVTY2F2ZW5nZSA9ICZxdW90O0NyZWF0ZVNjYXZlbmdlJnF1b3Q7CglFdmVudFR5cGVDb21taXRTb2x1dGlvbiA9ICZxdW90O0NvbW1pdFNvbHV0aW9uJnF1b3Q7CglFdmVudFR5cGVTb2x2ZVNjYXZlbmdlICA9ICZxdW90O1NvbHZlU2NhdmVuZ2UmcXVvdDsKCgkvLyBUT0RPOiBDcmVhdGUga2V5cyBmbyB5b3VyIGV2ZW50cywgdGhlIHZhbHVlcyB3aWxsIGJlIGRlcml2aWRlZCBmcm9tIHRoZSBtc2cKCS8vIEF0dHJpYnV0ZUtleUFkZHJlc3MgIAkJPSAmcXVvdDthZGRyZXNzJnF1b3Q7CglBdHRyaWJ1dGVEZXNjcmlwdGlvbiAgICAgICAgICAgPSAmcXVvdDtkZXNjcmlwdGlvbiZxdW90OwoJQXR0cmlidXRlU29sdXRpb24gICAgICAgICAgICAgID0gJnF1b3Q7c29sdXRpb24mcXVvdDsKCUF0dHJpYnV0ZVNvbHV0aW9uSGFzaCAgICAgICAgICA9ICZxdW90O3NvbHV0aW9uSGFzaCZxdW90OwoJQXR0cmlidXRlUmV3YXJkICAgICAgICAgICAgICAgID0gJnF1b3Q7cmV3YXJkJnF1b3Q7CglBdHRyaWJ1dGVTY2F2ZW5nZXIgICAgICAgICAgICAgPSAmcXVvdDtzY2F2ZW5nZXImcXVvdDsKCUF0dHJpYnV0ZVNvbHV0aW9uU2NhdmVuZ2VySGFzaCA9ICZxdW90O3NvbHV0aW9uU2NhdmVuZ2VySGFzaCZxdW90OwoKCS8vIFRPRE86IFNvbWUgZXZlbnRzIG1heSBub3QgaGF2ZSB2YWx1ZXMgZm9yIHRoYXQgcmVhc29uIHlvdSB3YW50IHRvIGVtaXQgdGhhdCBzb21ldGhpbmcgaGFwcGVuZWQuCgkvLyBBdHRyaWJ1dGVWYWx1ZURvdWJsZVNpZ24gPSAmcXVvdDtkb3VibGVfc2lnbiZxdW90OwoKCUF0dHJpYnV0ZVZhbHVlQ2F0ZWdvcnkgPSBNb2R1bGVOYW1lCikK"}}),l._v(" "),c("p",[l._v("Now that we have all the necessary pieces for updating state ("),c("code",[l._v("Message")]),l._v(", "),c("code",[l._v("Handler")]),l._v(", "),c("code",[l._v("Keeper")]),l._v(") we might want to consider ways in which we can "),c("em",[l._v("query")]),l._v(" state. This is typically done via a REST endpoint and/or a CLI. Both of those clients interact with part of the app which queries state, called the "),c("code",[l._v("Querier")]),l._v(".")])],1)}),[],!1,null,null,null);d.default=a.exports}}]);